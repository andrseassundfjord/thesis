Latent dimension: 64, Hidden dimension 512, Split size 4
Started: TimeBERT_cluster_sampled, Augmented run
Using device: cuda
Model: TimeBERT
Number of parameters in model:  36943186
torch.cuda.memory_allocated: 0.138609GB
torch.cuda.memory_reserved: 0.150391GB
torch.cuda.max_memory_reserved: 0.150391GB
Start training
Time taken: 410.28 seconds
Epoch: 9 	 Train Loss: 45506.461325	 Test Loss: 42574.294271
Time taken: 757.15 seconds
Epoch: 19 	 Train Loss: 45253.070317	 Test Loss: 42441.140914
Time taken: 1103.55 seconds
Epoch: 29 	 Train Loss: 45101.207013	 Test Loss: 42095.792168
Time taken: 1446.83 seconds
Epoch: 39 	 Train Loss: 45140.695192	 Test Loss: 41627.157427
Time taken: 1787.91 seconds
Epoch: 49 	 Train Loss: 45063.938982	 Test Loss: 41126.775309
Time taken: 2124.35 seconds
Epoch: 59 	 Train Loss: 44923.971397	 Test Loss: 41070.546740
Time taken: 2458.47 seconds
Epoch: 69 	 Train Loss: 44805.979122	 Test Loss: 41251.463021
Time taken: 2792.65 seconds
Epoch: 79 	 Train Loss: 44809.485432	 Test Loss: 41206.867921
Time taken: 3129.63 seconds
Epoch: 89 	 Train Loss: 44830.885206	 Test Loss: 41193.840625
Time taken: 3464.35 seconds
Epoch: 99 	 Train Loss: 44815.904968	 Test Loss: 41199.060012
Time taken: 3800.06 seconds
Epoch: 109 	 Train Loss: 44808.075203	 Test Loss: 41204.406973
Time taken: 4134.77 seconds
Epoch: 119 	 Train Loss: 44780.284313	 Test Loss: 41205.130681
Time taken: 4467.60 seconds
Epoch: 129 	 Train Loss: 44811.174830	 Test Loss: 41201.986690
Time taken: 4800.77 seconds
Epoch: 139 	 Train Loss: 44798.966552	 Test Loss: 41203.799913
Time taken: 5137.60 seconds
Epoch: 149 	 Train Loss: 44837.361231	 Test Loss: 41207.126447
Finished training
Time taken: 5137.60 seconds
Best test loss: 41031.710523 at epoch: 54
Timeseries loss: 40832.569010416664
Timeseries MAPE: 1.467699
Video MAPE: 0.000000
Masked MAPE: 1.833758
Started Cluster task
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results       GMM results
ARI:          -0.00062                    0.00000                  -0.00062
Rand:         0.23034                    0.00000                    0.23034
FM:           0.25857                    0.00000                    0.25857
Completeness: 0.03169                    0.00000                    0.03169
Homogeneity:  0.00401                    0.00000                    0.00401
V measure:    0.00712                    0.00000                    0.00712
Silhouette:   0.56716                    0.00000                    0.56716
CH Score:     2530.42311                 0.00000                    2530.42311

Cluster  4
              K-means results      Spectral clustering results       GMM results
ARI:          0.00057                    0.00064                  0.00068
Rand:         0.68205                    0.10143                    0.66686
FM:           0.15273                    0.28399                    0.15768
Completeness: 0.01138                    0.21853                    0.01139
Homogeneity:  0.00585                    0.00606                    0.00570
V measure:    0.00772                    0.01179                    0.00760
Silhouette:   0.07431                    -0.13842                    0.06222
CH Score:     908.99169                 5.15575                    869.36031

Cluster  6
              K-means results      Spectral clustering results       GMM results
ARI:          0.00071                    0.00064                  0.00085
Rand:         0.77300                    0.10295                    0.77390
FM:           0.11996                    0.28371                    0.11974
Completeness: 0.01058                    0.22024                    0.01082
Homogeneity:  0.00734                    0.00680                    0.00752
V measure:    0.00867                    0.01319                    0.00887
Silhouette:   0.07144                    -0.17334                    0.06394
CH Score:     566.94328                 3.38885                    548.13971

Cluster  8
              K-means results      Spectral clustering results       GMM results
ARI:          0.00133                    0.00062                  0.00216
Rand:         0.79879                    0.10599                    0.79947
FM:           0.10946                    0.28315                    0.11001
Completeness: 0.01581                    0.20943                    0.01808
Homogeneity:  0.01221                    0.00760                    0.01398
V measure:    0.01378                    0.01467                    0.01577
Silhouette:   0.05943                    -0.18146                    0.05295
CH Score:     419.37784                 2.75459                    409.22072

Cluster  10
              K-means results      Spectral clustering results       GMM results
ARI:          0.00043                    0.00062                  0.00215
Rand:         0.81862                    0.11207                    0.82677
FM:           0.09915                    0.28209                    0.09674
Completeness: 0.01639                    0.19169                    0.01743
Homogeneity:  0.01399                    0.00895                    0.01522
V measure:    0.01510                    0.01709                    0.01625
Silhouette:   0.02242                    -0.18346                    0.05437
CH Score:     334.64981                 2.48028                    327.41721

Cluster  12
              K-means results      Spectral clustering results       GMM results
ARI:          0.00078                    0.00085                  0.00059
Rand:         0.83944                    0.12934                    0.83963
FM:           0.08856                    0.27946                    0.08826
Completeness: 0.01659                    0.14557                    0.01608
Homogeneity:  0.01560                    0.01033                    0.01512
V measure:    0.01608                    0.01929                    0.01558
Silhouette:   0.02272                    -0.18627                    0.01774
CH Score:     278.93861                 2.50617                    273.62991

Cluster  14
              K-means results      Spectral clustering results       GMM results
ARI:          0.00153                    0.00083                  0.00183
Rand:         0.85336                    0.17927                    0.85318
FM:           0.08118                    0.27044                    0.08159
Completeness: 0.01827                    0.09484                    0.01855
Homogeneity:  0.01847                    0.01202                    0.01874
V measure:    0.01837                    0.02134                    0.01864
Silhouette:   0.02183                    -0.18665                    0.02026
CH Score:     239.20747                 2.85827                    236.95820
FOR PLOT
[0.5671621, 0.07430905, 0.07143606, 0.05943049, 0.022416526, 0.022720719, 0.021827802]
[2530.4231063242187, 908.9916931700421, 566.9432839481146, 419.377840290618, 334.64980823182225, 278.93861389602483, 239.20747295778165]
[0, -0.13841769, -0.17333592, -0.18145767, -0.18345676, -0.18627073, -0.1866478]
[0, 5.155750948178572, 3.388848994054067, 2.7545946734943274, 2.4802751196504835, 2.5061685800541875, 2.8582726345077556]
[0.5671621, 0.06221905, 0.06393572, 0.05294636, 0.054371394, 0.01773584, 0.020255074]
[2530.4231063242187, 869.3603086482015, 548.1397148457223, 409.22071579425403, 327.41721056953156, 273.62990880747367, 236.95819855455767]
 
Finished cluster for  TimeBERT
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
1 [ 28   0   0 272   0   0   0   0   0   0   0   0   0   0]
2 [ 36   0   0 256   0   8   0   0   0   0   0   0   0   0]
3 [ 40   0   0 260   0   0   0   0   0   0   0   0   0   0]
4 [ 32   0   0 268   0   0   0   0   0   0   0   0   0   0]
5 [  8   0   0 152   0   0   0   0   0   0   0   0   0   0]
6 [ 21   0   0 276   0   0   0   1   0   0   0   0   0   2]
7 [ 4  0  0 68  0  0  0  0  0  0  0  0  0  0]
8 [ 20   0   0 276   0   4   0   0   0   0   0   0   0   0]
9 [ 0  0  0 52  0  8  0  0  0  0  0  0  0  0]
10 [ 36   0   0 260   0   4   0   0   0   0   0   0   0   0]
11 [ 24   0   0 276   0   0   0   0   0   0   0   0   0   0]
12 [ 20   0   0 192   0   0   0   0   0   0   0   0   0   0]
13 [  4   0   0 100   0   4   0   0   0   0   0   0   0   0]
14 [ 48   0   0 180   0   0   0   0   0   0   0   0   0   0]
F1 Score: 0.023917372499111186
Finished GMM Classification for  TimeBERT
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['1', '5', '9']
1 [ 36   0 264]
2 [ 20   0 280]
3 [ 36   0 264]
F1 Score: 0.22006925513887868
Finished GMM Classification for  TimeBERT
lr: 0.1, hidden_dim: 1024

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.081465	 Test Loss: 0.089357
Epoch: 9 	 Train Loss: 0.079404	 Test Loss: 0.085649
Epoch: 14 	 Train Loss: 0.077715	 Test Loss: 0.084773
Epoch: 19 	 Train Loss: 0.077382	 Test Loss: 0.086153
Epoch: 24 	 Train Loss: 0.077227	 Test Loss: 0.084277
Epoch: 29 	 Train Loss: 0.076628	 Test Loss: 0.084091
Epoch: 34 	 Train Loss: 0.076733	 Test Loss: 0.084302
Epoch: 39 	 Train Loss: 0.077014	 Test Loss: 0.084224
Epoch: 44 	 Train Loss: 0.076640	 Test Loss: 0.083747
Epoch: 49 	 Train Loss: 0.076518	 Test Loss: 0.084111
Epoch: 54 	 Train Loss: 0.077092	 Test Loss: 0.083667
Epoch: 59 	 Train Loss: 0.076499	 Test Loss: 0.083715
Finished training
Best test loss: 0.083309 at epoch: 43
Start evaluation, classes for  range(0, 14)

Evaluation of fine-tuned TimeBERT model

Confusion matrix
['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
1 [  0   1   0 299   0   0   0   0   0   0   0   0   0   0]
2 [  1   1   2 294   0   1   0   0   0   0   0   0   0   1]
3 [  0   0   0 297   0   0   0   0   0   2   1   0   0   0]
4 [  0   0   0 299   0   0   0   0   0   1   0   0   0   0]
5 [  0   1   1 157   0   0   0   0   0   0   1   0   0   0]
6 [  0   1   0 297   0   0   0   0   0   1   1   0   0   0]
7 [ 0  0  0 71  0  0  0  0  0  0  1  0  0  0]
8 [  0   0   2 294   0   1   0   1   0   1   0   0   0   1]
9 [ 1  0  0 57  0  0  0  0  0  2  0  0  0  0]
10 [  0   1   0 296   1   0   0   1   0   0   1   0   0   0]
11 [  2   1   0 296   0   0   0   0   0   1   0   0   0   0]
12 [  0   1   0 211   0   0   0   0   0   0   0   0   0   0]
13 [  0   0   0 107   0   0   0   1   0   0   0   0   0   0]
14 [  1   0   1 222   0   0   0   0   0   3   1   0   0   0]
F1 Score: 0.01704805884431311
lr: 0.1, hidden_dim: 1024

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.062886	 Test Loss: 0.019284
Epoch: 9 	 Train Loss: 0.049008	 Test Loss: 0.018596
Epoch: 14 	 Train Loss: 0.039915	 Test Loss: 0.012970
Epoch: 19 	 Train Loss: 0.035947	 Test Loss: 0.014815
Epoch: 24 	 Train Loss: 0.068515	 Test Loss: 0.014697
Epoch: 29 	 Train Loss: 0.034741	 Test Loss: 0.012208
Epoch: 34 	 Train Loss: 0.034564	 Test Loss: 0.012226
Epoch: 39 	 Train Loss: 0.034526	 Test Loss: 0.013702
Epoch: 44 	 Train Loss: 0.034539	 Test Loss: 0.012317
Epoch: 49 	 Train Loss: 0.034490	 Test Loss: 0.012318
Epoch: 54 	 Train Loss: 0.034593	 Test Loss: 0.012210
Epoch: 59 	 Train Loss: 0.034524	 Test Loss: 0.012206
Finished training
Best test loss: 0.012190 at epoch: 21
Start evaluation, classes for  [1, 5, 9]

Evaluation of fine-tuned TimeBERT model

Confusion matrix
['1', '5', '9']
1 [299   1   0]
2 [300   0   0]
3 [300   0   0]
F1 Score: 0.1662496524881846

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.951195	 Test Loss: 1.014274
Epoch: 9 	 Train Loss: 0.862153	 Test Loss: 0.817957
Epoch: 14 	 Train Loss: 0.960128	 Test Loss: 0.856456
Epoch: 19 	 Train Loss: 0.952829	 Test Loss: 0.954128
Epoch: 24 	 Train Loss: 0.800585	 Test Loss: 0.806888
Epoch: 29 	 Train Loss: 0.792459	 Test Loss: 0.798064
Epoch: 34 	 Train Loss: 0.783965	 Test Loss: 0.788315
Epoch: 39 	 Train Loss: 0.775866	 Test Loss: 0.780141
Epoch: 44 	 Train Loss: 0.767755	 Test Loss: 0.772254
Epoch: 49 	 Train Loss: 0.760282	 Test Loss: 0.766120
Epoch: 54 	 Train Loss: 0.752446	 Test Loss: 0.758936
Epoch: 59 	 Train Loss: 0.750952	 Test Loss: 0.753103
Finished training TimeBERT for risk score prediction
Best test loss: 0.753103 at epoch: 59
Start evaluation

Evaluation of fine-tuned TimeBERT model

MAPE Score: 53.942115783691406

Finished
