Latent dimension: 64, Hidden dimension 512, Split size 4
Started: MAE, Augmented run
Using device: cuda
Model: MAE
Number of parameters in model:  395303725
torch.cuda.memory_allocated: 1.474783GB
torch.cuda.memory_reserved: 1.505859GB
torch.cuda.max_memory_reserved: 1.505859GB
Start training
Time taken: 2400.44 seconds
Epoch: 9 	 Train Loss: 145347.667022	 Test Loss: 141270.243827
Time taken: 4712.38 seconds
Epoch: 19 	 Train Loss: 129194.428876	 Test Loss: 125422.250000
Time taken: 7008.88 seconds
Epoch: 29 	 Train Loss: 123558.665690	 Test Loss: 123667.011574
Time taken: 9296.84 seconds
Epoch: 39 	 Train Loss: 120224.750799	 Test Loss: 122548.926080
Time taken: 11577.02 seconds
Epoch: 49 	 Train Loss: 118128.011987	 Test Loss: 116208.923148
Time taken: 13845.66 seconds
Epoch: 59 	 Train Loss: 116821.419286	 Test Loss: 115651.278704
Time taken: 16112.87 seconds
Epoch: 69 	 Train Loss: 114993.706713	 Test Loss: 113026.476389
Time taken: 19064.94 seconds
Epoch: 79 	 Train Loss: 105761.787693	 Test Loss: 102201.476003
Time taken: 22073.25 seconds
Epoch: 89 	 Train Loss: 101927.148708	 Test Loss: 96918.330710
Time taken: 25096.94 seconds
Epoch: 99 	 Train Loss: 98971.768780	 Test Loss: 95841.261420
Time taken: 28069.95 seconds
Epoch: 109 	 Train Loss: 98786.387320	 Test Loss: 94177.096296
Time taken: 30935.41 seconds
Epoch: 119 	 Train Loss: 98448.267981	 Test Loss: 94997.240741
Time taken: 33669.85 seconds
Epoch: 129 	 Train Loss: 96581.974694	 Test Loss: 92377.582330
Time taken: 36391.38 seconds
Epoch: 139 	 Train Loss: 96791.200320	 Test Loss: 93153.543133
Time taken: 38714.44 seconds
Epoch: 149 	 Train Loss: 97388.128663	 Test Loss: 93609.814043
Finished training
Time taken: 38714.44 seconds
Best test loss: 91172.759799 at epoch: 133
Timeseries loss: 8653.164209587192
Video loss: 80737.2546103395, at epoch: 133
Timeseries MAPE: 2.579635
Video MAPE: 1.601381
Masked MAPE: 2.794374
Started
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results
ARI:          -0.00028                    0.00004
Rand:         0.32089                    0.08248
FM:           0.24146                    0.28621 
Completeness: 0.02727                    0.33151 
Homogeneity:  0.00493                    0.00036 
V measure:    0.00835                    0.00073
Silhouette:   0.31788                    0.34174
CH Score:     1070.48519                 3.37326

Cluster  4
              K-means results      Spectral clustering results
ARI:          0.01115                    0.00003
Rand:         0.61938                    0.08298
FM:           0.18475                    0.28609 
Completeness: 0.05500                    0.29681 
Homogeneity:  0.02441                    0.00065 
V measure:    0.03381                    0.00130
Silhouette:   0.14885                    0.30554
CH Score:     555.28520                 3.20460

Cluster  6
              K-means results      Spectral clustering results
ARI:          0.01942                    0.00004
Rand:         0.76136                    0.08248
FM:           0.14456                    0.28621 
Completeness: 0.05677                    0.33151 
Homogeneity:  0.03764                    0.00036 
V measure:    0.04527                    0.00073
Silhouette:   0.10648                    0.34174
CH Score:     387.46854                 3.37326

Cluster  8
              K-means results      Spectral clustering results
ARI:          0.01926                    0.00004
Rand:         0.79880                    0.08248
FM:           0.12785                    0.28621 
Completeness: 0.05882                    0.33151 
Homogeneity:  0.04556                    0.00036 
V measure:    0.05135                    0.00073
Silhouette:   0.05714                    0.34174
CH Score:     304.53506                 3.37326

Cluster  10
              K-means results      Spectral clustering results
ARI:          0.02030                    0.00003
Rand:         0.81685                    0.08298
FM:           0.12015                    0.28609 
Completeness: 0.06609                    0.29681 
Homogeneity:  0.05603                    0.00065 
V measure:    0.06065                    0.00130
Silhouette:   0.05989                    0.30554
CH Score:     252.76893                 3.20460

Cluster  12
              K-means results      Spectral clustering results
ARI:          0.02182                    0.00003
Rand:         0.84210                    0.08298
FM:           0.10821                    0.28609 
Completeness: 0.06748                    0.29681 
Homogeneity:  0.06368                    0.00065 
V measure:    0.06552                    0.00130
Silhouette:   0.05187                    0.30554
CH Score:     216.99546                 3.20460

Cluster  14
              K-means results      Spectral clustering results
ARI:          0.02414                    0.00004
Rand:         0.85438                    0.08248
FM:           0.10338                    0.28621 
Completeness: 0.06743                    0.33151 
Homogeneity:  0.06806                    0.00036 
V measure:    0.06774                    0.00073
Silhouette:   0.04738                    0.34174
CH Score:     190.77830                 3.37326
Finished cluster for  MAE

Start classification fine-tuning
Traceback (most recent call last):
  File "run_MVAE_augmented.py", line 588, in <module>
    timeseries_num_layers = timeseries_num_layers,
  File "/work6/a_sundfjord/thesis/feature_extraction/classification.py", line 146, in train_test_classification
    loss += reg_loss(simple_model)
  File "/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/torch/nn/modules/loss.py", line 1174, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/torch/nn/functional.py", line 3026, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument weight in method wrapper_nll_loss_forward)
