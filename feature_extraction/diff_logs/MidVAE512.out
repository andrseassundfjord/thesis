Latent dimension: 64, Hidden dimension 512, Split size 4
Started: MidMVAE, Augmented run
Using device: cuda
Model: MidMVAE
Number of parameters in model:  281535963
torch.cuda.memory_allocated: 1.049793GB
torch.cuda.memory_reserved: 1.058594GB
torch.cuda.max_memory_reserved: 1.058594GB
Start training
Time taken: 4580.14 seconds
Epoch: 9 	 Train Loss: 261634.150506	 Test Loss: 258321.211420
Time taken: 9255.14 seconds
Epoch: 19 	 Train Loss: 221508.393980	 Test Loss: 226047.437191
Time taken: 13844.01 seconds
Epoch: 29 	 Train Loss: 217252.482952	 Test Loss: 217117.390586
Time taken: 17452.54 seconds
Epoch: 39 	 Train Loss: 207656.141449	 Test Loss: 203935.536883
Time taken: 21101.38 seconds
Epoch: 49 	 Train Loss: 201143.472563	 Test Loss: 196622.325154
Time taken: 24757.82 seconds
Epoch: 59 	 Train Loss: 198954.928609	 Test Loss: 196764.495370
Time taken: 28408.30 seconds
Epoch: 69 	 Train Loss: 198151.922216	 Test Loss: 195994.026543
Time taken: 32277.53 seconds
Epoch: 79 	 Train Loss: 197848.589238	 Test Loss: 196102.085494
Time taken: 36682.05 seconds
Epoch: 89 	 Train Loss: 197873.812200	 Test Loss: 196040.544290
Time taken: 41416.94 seconds
Epoch: 99 	 Train Loss: 197839.762920	 Test Loss: 196062.483179
Time taken: 46830.09 seconds
Epoch: 109 	 Train Loss: 198007.963239	 Test Loss: 196060.942130
Time taken: 52530.24 seconds
Epoch: 119 	 Train Loss: 197252.359616	 Test Loss: 196044.769907
Time taken: 58242.98 seconds
Epoch: 129 	 Train Loss: 197813.322856	 Test Loss: 196127.593827
Time taken: 63381.97 seconds
Epoch: 139 	 Train Loss: 197542.646777	 Test Loss: 196063.414660
Time taken: 67812.21 seconds
Epoch: 149 	 Train Loss: 197838.367075	 Test Loss: 196015.276389
Finished training
Time taken: 67812.21 seconds
Best test loss: 194302.696605 at epoch: 45
Timeseries loss: 40071.45441502701
Video loss: 153018.4994212963, at epoch: 45
Timeseries MAPE: 3.012246
Video MAPE: 1.554446
Masked MAPE: 3.079014
Started
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results
ARI:          0.00596                    0.00013
Rand:         0.37848                    0.09638
FM:           0.23880                    0.28397 
Completeness: 0.06093                    0.09710 
Homogeneity:  0.01278                    0.00189 
V measure:    0.02113                    0.00371
Silhouette:   0.72996                    0.53112
CH Score:     9966.41648                 132.93364

Cluster  4
              K-means results      Spectral clustering results
ARI:          0.01509                    0.00622
Rand:         0.64894                    0.38967
FM:           0.18039                    0.23672 
Completeness: 0.05951                    0.07290 
Homogeneity:  0.02900                    0.01683 
V measure:    0.03900                    0.02734
Silhouette:   0.52779                    0.70731
CH Score:     7226.80723                 4166.34909

Cluster  6
              K-means results      Spectral clustering results
ARI:          0.01426                    0.01024
Rand:         0.70769                    0.51786
FM:           0.15959                    0.21177 
Completeness: 0.06916                    0.07390 
Homogeneity:  0.04162                    0.02688 
V measure:    0.05197                    0.03942
Silhouette:   0.50814                    0.48005
CH Score:     6982.79303                 3555.89788

Cluster  8
              K-means results      Spectral clustering results
ARI:          0.01760                    0.01171
Rand:         0.75720                    0.53568
FM:           0.14432                    0.20906 
Completeness: 0.07240                    0.08550 
Homogeneity:  0.05138                    0.03375 
V measure:    0.06011                    0.04839
Silhouette:   0.51753                    0.45953
CH Score:     7045.19318                 2884.22051

Cluster  10
              K-means results      Spectral clustering results
ARI:          0.01819                    0.01140
Rand:         0.76343                    0.54161
FM:           0.14239                    0.20706 
Completeness: 0.08066                    0.08644 
Homogeneity:  0.06052                    0.03631 
V measure:    0.06916                    0.05114
Silhouette:   0.54246                    0.38714
CH Score:     7085.11411                 2390.86956

Cluster  12
              K-means results      Spectral clustering results
ARI:          0.02253                    0.01346
Rand:         0.78642                    0.70186
FM:           0.13696                    0.16075 
Completeness: 0.08727                    0.07372 
Homogeneity:  0.07155                    0.04528 
V measure:    0.07863                    0.05610
Silhouette:   0.54925                    0.50104
CH Score:     7268.50446                 3762.27185

Cluster  14
              K-means results      Spectral clustering results
ARI:          0.02242                    0.01227
Rand:         0.79591                    0.55696
FM:           0.13247                    0.20405 
Completeness: 0.08946                    0.10600 
Homogeneity:  0.07842                    0.05228 
V measure:    0.08358                    0.07003
Silhouette:   0.57881                    0.37950
CH Score:     7599.82493                 1935.36151
Finished cluster for  MidMVAE

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.095596	 Test Loss: 0.099667
Epoch: 9 	 Train Loss: 0.092703	 Test Loss: 0.096673
Epoch: 14 	 Train Loss: 0.082930	 Test Loss: 0.084683
Epoch: 19 	 Train Loss: 0.082946	 Test Loss: 0.084677
Epoch: 24 	 Train Loss: 0.082865	 Test Loss: 0.084663
Epoch: 29 	 Train Loss: 0.082859	 Test Loss: 0.084661
Epoch: 34 	 Train Loss: 0.082857	 Test Loss: 0.084662
Epoch: 39 	 Train Loss: 0.082857	 Test Loss: 0.084662
Epoch: 44 	 Train Loss: 0.082857	 Test Loss: 0.084662
Epoch: 49 	 Train Loss: 0.082858	 Test Loss: 0.084662
Epoch: 54 	 Train Loss: 0.082856	 Test Loss: 0.084662
Epoch: 59 	 Train Loss: 0.082862	 Test Loss: 0.084662
Finished training
Best test loss: 0.084661 at epoch: 29
Start evaluation

Evaluation of fine-tuned MidMVAE model

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
2 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
3 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
4 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
5 [  0   0   0   0   0   0   0   0   0   0 160   0   0   0]
6 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
7 [ 0  0  0  0  0  0  0  0  0  0 72  0  0  0]
8 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
9 [ 0  0  0  0  0  0  0  0  0  0 60  0  0  0]
10 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
11 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
12 [  0   0   0   0   0   0   0   0   0   0 212   0   0   0]
13 [  0   0   0   0   0   0   0   0   0   0 108   0   0   0]
14 [  0   0   0   0   0   0   0   0   0   0 228   0   0   0]
F1 Score: 0.015693659761456372

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.802920	 Test Loss: 0.819095
Epoch: 9 	 Train Loss: 1.082169	 Test Loss: 0.874326
Epoch: 14 	 Train Loss: 0.955973	 Test Loss: 0.925746
Epoch: 19 	 Train Loss: 0.801485	 Test Loss: 0.822614
Epoch: 24 	 Train Loss: 0.797997	 Test Loss: 0.815047
Epoch: 29 	 Train Loss: 0.015616	 Test Loss: 0.016344
Epoch: 34 	 Train Loss: 0.014361	 Test Loss: 0.015075
Epoch: 39 	 Train Loss: 0.013223	 Test Loss: 0.013880
Epoch: 44 	 Train Loss: 0.012323	 Test Loss: 0.012988
Epoch: 49 	 Train Loss: 0.011488	 Test Loss: 0.012421
Epoch: 54 	 Train Loss: 0.010890	 Test Loss: 0.011660
Epoch: 59 	 Train Loss: 0.010417	 Test Loss: 0.011135
Finished training MidMVAE for risk score prediction
Best test loss: 0.011135 at epoch: 59
Start evaluation

Evaluation of fine-tuned MidMVAE model

MAPE Score: 1.2850440740585327

Finished
