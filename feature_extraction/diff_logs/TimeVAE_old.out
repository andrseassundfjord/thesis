Latent dimension: 64, Hidden dimension 512, Split size 4
Started: TimeVAE, Augmented run
Using device: cuda
Model: TimeseriesVAE
Number of parameters in model:  105422966
torch.cuda.memory_allocated: 0.394895GB
torch.cuda.memory_reserved: 0.421875GB
torch.cuda.max_memory_reserved: 0.421875GB
Start training
Time taken: 1522.14 seconds
Epoch: 9 	 Train Loss: 7665.493469	 Test Loss: 4665.564757
Time taken: 3089.62 seconds
Epoch: 19 	 Train Loss: 6706.543762	 Test Loss: 4327.269136
Time taken: 4661.02 seconds
Epoch: 29 	 Train Loss: 6096.174019	 Test Loss: 4579.097290
Time taken: 6225.08 seconds
Epoch: 39 	 Train Loss: 5335.712819	 Test Loss: 4186.361699
Time taken: 7799.83 seconds
Epoch: 49 	 Train Loss: 4906.083690	 Test Loss: 3795.567877
Time taken: 9372.65 seconds
Epoch: 59 	 Train Loss: 4688.177296	 Test Loss: 3727.589439
Time taken: 10940.01 seconds
Epoch: 69 	 Train Loss: 4556.005011	 Test Loss: 3710.060822
Time taken: 12501.59 seconds
Epoch: 79 	 Train Loss: 4183.853286	 Test Loss: 3651.839101
Time taken: 14067.09 seconds
Epoch: 89 	 Train Loss: 3948.608272	 Test Loss: 3614.042149
Time taken: 15628.75 seconds
Epoch: 99 	 Train Loss: 3947.700274	 Test Loss: 3638.607948
Time taken: 17194.82 seconds
Epoch: 109 	 Train Loss: 3890.927057	 Test Loss: 3593.487505
Time taken: 18824.19 seconds
Epoch: 119 	 Train Loss: 3880.069401	 Test Loss: 3550.093224
Time taken: 20446.32 seconds
Epoch: 129 	 Train Loss: 3863.358809	 Test Loss: 3590.187659
Time taken: 22049.18 seconds
Epoch: 139 	 Train Loss: 3912.372894	 Test Loss: 3589.923765
Time taken: 23618.62 seconds
Epoch: 149 	 Train Loss: 3737.349329	 Test Loss: 3517.503178
Finished training
Time taken: 23618.62 seconds
Best test loss: 3517.503178 at epoch: 149
Timeseries loss: 3403.904160638503
Timeseries MAPE: 2.554821
Video MAPE: 0.000000
Started
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results
ARI:          0.00095                    -0.00001
Rand:         0.14669                    0.08243
FM:           0.27653                    0.28611 
Completeness: 0.10136                    0.26214 
Homogeneity:  0.00666                    0.00029 
V measure:    0.01249                    0.00058
Silhouette:   0.82539                    0.74186
CH Score:     6769.68432                 15.27153

Cluster  4
              K-means results      Spectral clustering results
ARI:          0.01330                    -0.00001
Rand:         0.57246                    0.08243
FM:           0.20108                    0.28611 
Completeness: 0.07872                    0.26214 
Homogeneity:  0.03190                    0.00029 
V measure:    0.04541                    0.00058
Silhouette:   0.28986                    0.74186
CH Score:     4230.18351                 15.27153

Cluster  6
              K-means results      Spectral clustering results
ARI:          0.01917                    -0.00001
Rand:         0.73542                    0.08243
FM:           0.15471                    0.28611 
Completeness: 0.07735                    0.26214 
Homogeneity:  0.04879                    0.00029 
V measure:    0.05984                    0.00058
Silhouette:   0.22540                    0.74186
CH Score:     3078.10222                 15.27153

Cluster  8
              K-means results      Spectral clustering results
ARI:          0.01719                    -0.00001
Rand:         0.74769                    0.08243
FM:           0.14773                    0.28611 
Completeness: 0.09436                    0.26214 
Homogeneity:  0.06562                    0.00029 
V measure:    0.07741                    0.00058
Silhouette:   0.23672                    0.74186
CH Score:     2577.20566                 15.27153

Cluster  10
              K-means results      Spectral clustering results
ARI:          0.02330                    -0.00001
Rand:         0.80159                    0.08243
FM:           0.13070                    0.28611 
Completeness: 0.09238                    0.26214 
Homogeneity:  0.07451                    0.00029 
V measure:    0.08249                    0.00058
Silhouette:   0.21549                    0.74186
CH Score:     2234.14559                 15.27153

Cluster  12
              K-means results      Spectral clustering results
ARI:          0.02454                    -0.00001
Rand:         0.81939                    0.08243
FM:           0.12315                    0.28611 
Completeness: 0.09395                    0.26214 
Homogeneity:  0.08194                    0.00029 
V measure:    0.08754                    0.00058
Silhouette:   0.21948                    0.74186
CH Score:     1950.31447                 15.27153

Cluster  14
              K-means results      Spectral clustering results
ARI:          0.02575                    -0.00001
Rand:         0.83965                    0.08243
FM:           0.11354                    0.28611 
Completeness: 0.09972                    0.26214 
Homogeneity:  0.09544                    0.00029 
V measure:    0.09753                    0.00058
Silhouette:   0.22157                    0.74186
CH Score:     1754.17717                 15.27153
Finished cluster for  TimeseriesVAE

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.102630	 Test Loss: 0.104755
Epoch: 9 	 Train Loss: 0.102338	 Test Loss: 0.097125
Epoch: 14 	 Train Loss: 0.082974	 Test Loss: 0.084751
Epoch: 19 	 Train Loss: 0.082897	 Test Loss: 0.084655
Epoch: 24 	 Train Loss: 0.082881	 Test Loss: 0.084670
Epoch: 29 	 Train Loss: 0.082830	 Test Loss: 0.084628
Epoch: 34 	 Train Loss: 0.082820	 Test Loss: 0.084628
Epoch: 39 	 Train Loss: 0.082813	 Test Loss: 0.084628
Epoch: 44 	 Train Loss: 0.082811	 Test Loss: 0.084628
Epoch: 49 	 Train Loss: 0.082810	 Test Loss: 0.084628
Epoch: 54 	 Train Loss: 0.082812	 Test Loss: 0.084628
Epoch: 59 	 Train Loss: 0.082811	 Test Loss: 0.084628
Finished training
Best test loss: 0.084628 at epoch: 40
Start evaluation

Evaluation of fine-tuned TimeseriesVAE model

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [  0   0   0 300   0   0   0   0   0   0   0   0   0   0]
2 [  0   0   0 300   0   0   0   0   0   0   0   0   0   0]
3 [  0   0   0 300   0   0   0   0   0   0   0   0   0   0]
4 [  0   0   0 300   0   0   0   0   0   0   0   0   0   0]
5 [  0   0   0 160   0   0   0   0   0   0   0   0   0   0]
6 [  0   0   0 300   0   0   0   0   0   0   0   0   0   0]
7 [ 0  0  0 72  0  0  0  0  0  0  0  0  0  0]
8 [  0   0   0 300   0   0   0   0   0   0   0   0   0   0]
9 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0]
10 [  0   0   0 300   0   0   0   0   0   0   0   0   0   0]
11 [  0   0   0 300   0   0   0   0   0   0   0   0   0   0]
12 [  0   0   0 212   0   0   0   0   0   0   0   0   0   0]
13 [  0   0   0 108   0   0   0   0   0   0   0   0   0   0]
14 [  0   0   0 228   0   0   0   0   0   0   0   0   0   0]
F1 Score: 0.015693659761456372

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.890098	 Test Loss: 1.187758
Epoch: 9 	 Train Loss: 0.817277	 Test Loss: 0.822430
Epoch: 14 	 Train Loss: 0.800571	 Test Loss: 0.828043
Epoch: 19 	 Train Loss: 0.816860	 Test Loss: 0.891558
Epoch: 24 	 Train Loss: 0.133067	 Test Loss: 0.110955
Epoch: 29 	 Train Loss: 0.069346	 Test Loss: 0.057905
Epoch: 34 	 Train Loss: 0.052060	 Test Loss: 0.066494
Epoch: 39 	 Train Loss: 0.048277	 Test Loss: 0.046884
Epoch: 44 	 Train Loss: 0.010365	 Test Loss: 0.010904
Epoch: 49 	 Train Loss: 0.009386	 Test Loss: 0.010043
Epoch: 54 	 Train Loss: 0.009050	 Test Loss: 0.009732
Epoch: 59 	 Train Loss: 0.008789	 Test Loss: 0.009540
Finished training TimeseriesVAE for risk score prediction
Best test loss: 0.009540 at epoch: 59
Start evaluation

Evaluation of fine-tuned TimeseriesVAE model

MAPE Score: 1.1951984167099

Finished

***
Exited at iteration for spectral
***