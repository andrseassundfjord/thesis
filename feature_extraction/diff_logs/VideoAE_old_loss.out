Latent dimension: 64, Hidden dimension 512, Split size 4
Started: VideoAE, Augmented run
Using device: cuda
Model: VideoAutoencoder
Number of parameters in model:  289787203
torch.cuda.memory_allocated: 1.079546GB
torch.cuda.memory_reserved: 1.083984GB
torch.cuda.max_memory_reserved: 1.083984GB
Start training
Time taken: 1249.32 seconds
Epoch: 9 	 Train Loss: 115372.031167	 Test Loss: 109462.498920
Time taken: 2589.29 seconds
Epoch: 19 	 Train Loss: 96759.561668	 Test Loss: 94282.542130
Time taken: 3912.97 seconds
Epoch: 29 	 Train Loss: 91133.414957	 Test Loss: 88743.487114
Time taken: 5200.84 seconds
Epoch: 39 	 Train Loss: 88237.305674	 Test Loss: 87696.464198
Time taken: 6492.38 seconds
Epoch: 49 	 Train Loss: 84976.608151	 Test Loss: 84354.272608
Time taken: 7738.65 seconds
Epoch: 59 	 Train Loss: 83641.481886	 Test Loss: 82830.507948
Time taken: 8985.38 seconds
Epoch: 69 	 Train Loss: 82344.196723	 Test Loss: 82068.480941
Time taken: 10211.51 seconds
Epoch: 79 	 Train Loss: 81337.929875	 Test Loss: 81816.841744
Time taken: 11447.98 seconds
Epoch: 89 	 Train Loss: 80187.986747	 Test Loss: 80897.594444
Time taken: 12669.55 seconds
Epoch: 99 	 Train Loss: 79247.547150	 Test Loss: 80460.076543
Time taken: 13908.92 seconds
Epoch: 109 	 Train Loss: 78372.090237	 Test Loss: 80182.229784
Time taken: 15129.60 seconds
Epoch: 119 	 Train Loss: 77673.428809	 Test Loss: 79171.102778
Time taken: 16360.75 seconds
Epoch: 129 	 Train Loss: 77174.961641	 Test Loss: 79516.392593
Time taken: 17590.39 seconds
Epoch: 139 	 Train Loss: 76275.061201	 Test Loss: 78849.688735
Time taken: 18817.35 seconds
Epoch: 149 	 Train Loss: 75718.572722	 Test Loss: 78154.888889
Finished training
Time taken: 18817.35 seconds
Best test loss: 78154.888889 at epoch: 149
Video loss: 76452.02860725309, at epoch: 149
Timeseries MAPE: 0.000000
Video MAPE: 1.611919
Started
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results
ARI:          -0.00048                    0.00004
Rand:         0.31462                    0.08248
FM:           0.24242                    0.28621 
Completeness: 0.02988                    0.33151 
Homogeneity:  0.00529                    0.00036 
V measure:    0.00900                    0.00073
Silhouette:   0.32326                    0.34705
CH Score:     1091.51308                 3.46336

Cluster  4
              K-means results      Spectral clustering results
ARI:          0.01385                    0.00002
Rand:         0.69587                    0.08452
FM:           0.16329                    0.28581 
Completeness: 0.04696                    0.25899 
Homogeneity:  0.02478                    0.00132 
V measure:    0.03244                    0.00263
Silhouette:   0.12170                    0.25019
CH Score:     562.55045                 4.06789

Cluster  6
              K-means results      Spectral clustering results
ARI:          0.01789                    0.00004
Rand:         0.78242                    0.08505
FM:           0.13391                    0.28575 
Completeness: 0.04652                    0.26531 
Homogeneity:  0.03268                    0.00171 
V measure:    0.03839                    0.00339
Silhouette:   0.09961                    0.22399
CH Score:     384.60244                 3.17083

Cluster  8
              K-means results      Spectral clustering results
ARI:          0.02146                    0.00004
Rand:         0.80791                    0.08609
FM:           0.12576                    0.28559 
Completeness: 0.05961                    0.26948 
Homogeneity:  0.04744                    0.00233 
V measure:    0.05283                    0.00461
Silhouette:   0.06179                    0.16289
CH Score:     301.00628                 2.85830

Cluster  10
              K-means results      Spectral clustering results
ARI:          0.02308                    0.00008
Rand:         0.82659                    0.08715
FM:           0.11794                    0.28546 
Completeness: 0.06713                    0.27521 
Homogeneity:  0.05849                    0.00298 
V measure:    0.06251                    0.00590
Silhouette:   0.05373                    0.12879
CH Score:     249.72172                 2.62922

Cluster  12
              K-means results      Spectral clustering results
ARI:          0.02312                    0.00004
Rand:         0.84103                    0.08865
FM:           0.11012                    0.28513 
Completeness: 0.07099                    0.27545 
Homogeneity:  0.06680                    0.00385 
V measure:    0.06883                    0.00759
Silhouette:   0.05140                    0.10866
CH Score:     214.74058                 2.74660

Cluster  14
              K-means results      Spectral clustering results
ARI:          0.02609                    0.00004
Rand:         0.85662                    0.08968
FM:           0.10400                    0.28496 
Completeness: 0.07596                    0.27572 
Homogeneity:  0.07705                    0.00446 
V measure:    0.07650                    0.00877
Silhouette:   0.04626                    0.10099
CH Score:     188.76095                 2.67542
Finished cluster for  VideoAutoencoder

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.093372	 Test Loss: 0.094979
Epoch: 9 	 Train Loss: 0.084108	 Test Loss: 0.084836
Epoch: 14 	 Train Loss: 0.082955	 Test Loss: 0.084673
Epoch: 19 	 Train Loss: 0.082919	 Test Loss: 0.084688
Epoch: 24 	 Train Loss: 0.082845	 Test Loss: 0.084658
Epoch: 29 	 Train Loss: 0.082851	 Test Loss: 0.084656
Epoch: 34 	 Train Loss: 0.082849	 Test Loss: 0.084656
Epoch: 39 	 Train Loss: 0.082850	 Test Loss: 0.084656
Epoch: 44 	 Train Loss: 0.082843	 Test Loss: 0.084656
Epoch: 49 	 Train Loss: 0.082848	 Test Loss: 0.084656
Epoch: 54 	 Train Loss: 0.082845	 Test Loss: 0.084656
Epoch: 59 	 Train Loss: 0.082844	 Test Loss: 0.084656
Finished training
Best test loss: 0.084655 at epoch: 16
Start evaluation

Evaluation of fine-tuned VideoAutoencoder model

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
2 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
3 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
4 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
5 [  0   0   0   0   0   0   0   0   0   0 160   0   0   0]
6 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
7 [ 0  0  0  0  0  0  0  0  0  0 72  0  0  0]
8 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
9 [ 0  0  0  0  0  0  0  0  0  0 60  0  0  0]
10 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
11 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
12 [  0   0   0   0   0   0   0   0   0   0 212   0   0   0]
13 [  0   0   0   0   0   0   0   0   0   0 108   0   0   0]
14 [  0   0   0   0   0   0   0   0   0   0 228   0   0   0]
F1 Score: 0.015693659761456372

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 1.125162	 Test Loss: 1.064737
Epoch: 9 	 Train Loss: 0.909965	 Test Loss: 0.906891
Epoch: 14 	 Train Loss: 0.807800	 Test Loss: 0.826534
Epoch: 19 	 Train Loss: 0.027661	 Test Loss: 0.033280
Epoch: 24 	 Train Loss: 0.017382	 Test Loss: 0.017209
Epoch: 29 	 Train Loss: 0.013768	 Test Loss: 0.012708
Epoch: 34 	 Train Loss: 0.011082	 Test Loss: 0.011724
Epoch: 39 	 Train Loss: 0.017285	 Test Loss: 0.016855
Epoch: 44 	 Train Loss: 0.009652	 Test Loss: 0.010352
Epoch: 49 	 Train Loss: 0.009187	 Test Loss: 0.009860
Epoch: 54 	 Train Loss: 0.008895	 Test Loss: 0.009612
Epoch: 59 	 Train Loss: 0.008752	 Test Loss: 0.009466
Finished training VideoAutoencoder for risk score prediction
Best test loss: 0.009444 at epoch: 58
Start evaluation
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 285 with accuracies 
[2.21789619e-15 4.94257636e-05 4.16396121e-05 5.14624595e-05
 3.83028260e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 285 instead with accuracy 
3.616613224975245e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 292 with accuracies 
[3.18905759e-15 4.30087569e-05 5.41457525e-05 4.52879456e-05
 4.22577984e-05 4.80707251e-05 4.10872890e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 292 instead with accuracy 
3.9122609633251354e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 282 with accuracies 
[4.60518185e-15 3.32997803e-05 4.05518334e-05 4.69066861e-05
 4.62879850e-05 4.36640006e-05 7.36576941e-05 5.03954047e-05
 4.62208211e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 282 instead with accuracy 
4.233157836935753e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 242 with accuracies 
[1.88378151e-15 3.81404196e-05 6.53089192e-05 4.39114073e-05
 6.63907075e-05 4.84767268e-05 9.32305782e-05 3.98008821e-05
 9.34647194e-05 6.35954628e-05 3.80096113e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 239 instead with accuracy 
5.252093977845791e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 261 with accuracies 
[2.02727045e-15 3.21384700e-05 5.91506750e-05 4.56528606e-05
 4.04896431e-05 6.63042066e-05 3.71067889e-05 4.80393914e-05
 4.46897118e-05 9.71561988e-05 3.86860438e-05 5.04152041e-05
 4.53979343e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 257 instead with accuracy 
4.65300491951316e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 252 with accuracies 
[2.06495731e-15 4.09645828e-05 3.02145779e-05 4.17001991e-05
 5.13766323e-05 2.81054878e-05 5.07826167e-05 4.31102490e-05
 8.25238352e-05 5.45173001e-05 4.27731402e-05 4.52427159e-05
 4.63358066e-05 4.65411005e-05 4.82205281e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 252 instead with accuracy 
4.3493918154597766e-05.

  _, diffusion_map = lobpcg(

Evaluation of fine-tuned VideoAutoencoder model

MAPE Score: 1.0740572214126587

Finished
