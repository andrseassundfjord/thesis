Latent dimension: 64, Hidden dimension 512, Split size 4
Started: MVAE_triplet, Augmented run
Using device: cuda
Model: MVAE
Number of parameters in model:  395208622
torch.cuda.memory_allocated: 1.474424GB
torch.cuda.memory_reserved: 1.503906GB
torch.cuda.max_memory_reserved: 1.503906GB
Start training
Time taken: 5270.16 seconds
Epoch: 9 	 Train Loss: 144294.208178	 Test Loss: 141878.637037
Time taken: 10206.08 seconds
Epoch: 19 	 Train Loss: 126358.502264	 Test Loss: 127597.217901
Time taken: 14743.90 seconds
Epoch: 29 	 Train Loss: 119921.145178	 Test Loss: 121797.357330
Time taken: 17943.55 seconds
Epoch: 39 	 Train Loss: 115887.796351	 Test Loss: 118449.327006
Time taken: 21342.80 seconds
Epoch: 49 	 Train Loss: 113266.634390	 Test Loss: 116711.060185
Time taken: 24270.37 seconds
Epoch: 59 	 Train Loss: 111244.292288	 Test Loss: 115345.859799
Time taken: 26631.36 seconds
Epoch: 69 	 Train Loss: 109610.537693	 Test Loss: 114046.798457
Time taken: 28977.38 seconds
Epoch: 79 	 Train Loss: 108271.369872	 Test Loss: 113265.031559
Time taken: 31298.42 seconds
Epoch: 89 	 Train Loss: 107047.244140	 Test Loss: 112472.708796
Time taken: 33596.24 seconds
Epoch: 99 	 Train Loss: 105843.612147	 Test Loss: 111777.824074
Time taken: 35901.52 seconds
Epoch: 109 	 Train Loss: 104752.896244	 Test Loss: 111288.760957
Time taken: 38194.60 seconds
Epoch: 119 	 Train Loss: 103842.738612	 Test Loss: 110748.802392
Time taken: 40486.06 seconds
Epoch: 129 	 Train Loss: 102974.973628	 Test Loss: 110546.839815
Time taken: 42779.61 seconds
Epoch: 139 	 Train Loss: 102285.573655	 Test Loss: 110088.970602
Time taken: 45071.65 seconds
Epoch: 149 	 Train Loss: 101486.261721	 Test Loss: 109815.058488
Finished training
Time taken: 45071.65 seconds
Best test loss: 109815.058488 at epoch: 149
Timeseries loss: 32466.86777826003
Video loss: 75586.49544753086, at epoch: 149
Timeseries MAPE: 2.676537
Video MAPE: 1.614203
Masked MAPE: 2.846651
Started
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results
ARI:          -0.00077                    0.00004
Rand:         0.31097                    0.08248
FM:           0.24270                    0.28621 
Completeness: 0.02741                    0.33151 
Homogeneity:  0.00480                    0.00036 
V measure:    0.00818                    0.00073
Silhouette:   0.29965                    0.30923
CH Score:     728.87810                 2.93325

Cluster  4
              K-means results      Spectral clustering results
ARI:          0.01671                    0.00009
Rand:         0.70484                    0.08407
FM:           0.16338                    0.28601 
Completeness: 0.05222                    0.27694 
Homogeneity:  0.02791                    0.00117 
V measure:    0.03637                    0.00233
Silhouette:   0.06590                    0.28349
CH Score:     373.53066                 4.02257

Cluster  6
              K-means results      Spectral clustering results
ARI:          0.01654                    0.00008
Rand:         0.75970                    0.08561
FM:           0.14216                    0.28573 
Completeness: 0.05322                    0.28121 
Homogeneity:  0.03544                    0.00207 
V measure:    0.04255                    0.00411
Silhouette:   0.05751                    0.20466
CH Score:     266.63043                 3.78054

Cluster  8
              K-means results      Spectral clustering results
ARI:          0.02422                    0.00005
Rand:         0.80821                    0.08661
FM:           0.12843                    0.28551 
Completeness: 0.06786                    0.27683 
Homogeneity:  0.05392                    0.00265 
V measure:    0.06009                    0.00525
Silhouette:   0.05120                    0.19761
CH Score:     212.32248                 3.46056

Cluster  10
              K-means results      Spectral clustering results
ARI:          0.02260                    0.00002
Rand:         0.82646                    0.08761
FM:           0.11752                    0.28529 
Completeness: 0.06667                    0.27410 
Homogeneity:  0.05825                    0.00322 
V measure:    0.06217                    0.00637
Silhouette:   0.04840                    0.18929
CH Score:     175.88080                 3.38997

Cluster  12
              K-means results      Spectral clustering results
ARI:          0.02464                    -0.00000
Rand:         0.84093                    0.08862
FM:           0.11170                    0.28507 
Completeness: 0.07081                    0.27229 
Homogeneity:  0.06652                    0.00380 
V measure:    0.06860                    0.00750
Silhouette:   0.04198                    0.17711
CH Score:     152.59296                 3.23031

Cluster  14
              K-means results      Spectral clustering results
ARI:          0.02421                    0.00001
Rand:         0.85523                    0.08915
FM:           0.10294                    0.28501 
Completeness: 0.07689                    0.28181 
Homogeneity:  0.07770                    0.00429 
V measure:    0.07729                    0.00846
Silhouette:   0.04256                    0.17132
CH Score:     135.87559                 2.97048
Finished cluster for  MVAE

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.082973	 Test Loss: 0.084720
Epoch: 9 	 Train Loss: 0.082972	 Test Loss: 0.084719
Epoch: 14 	 Train Loss: 0.082941	 Test Loss: 0.084701
Epoch: 19 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 24 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 29 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 34 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 39 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 44 	 Train Loss: 0.082936	 Test Loss: 0.084699
Epoch: 49 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 54 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 59 	 Train Loss: 0.082937	 Test Loss: 0.084699
Finished training
Best test loss: 0.084699 at epoch: 24
Start evaluation

Evaluation of fine-tuned MVAE model

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
2 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
3 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
4 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
5 [  0 160   0   0   0   0   0   0   0   0   0   0   0   0]
6 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
7 [ 0 72  0  0  0  0  0  0  0  0  0  0  0  0]
8 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
9 [ 0 60  0  0  0  0  0  0  0  0  0  0  0  0]
10 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
11 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
12 [  0 212   0   0   0   0   0   0   0   0   0   0   0   0]
13 [  0 108   0   0   0   0   0   0   0   0   0   0   0   0]
14 [  0 228   0   0   0   0   0   0   0   0   0   0   0   0]
F1 Score: 0.015693659761456372

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 1.095200	 Test Loss: 1.252463
Epoch: 9 	 Train Loss: 1.168222	 Test Loss: 0.894590
Epoch: 14 	 Train Loss: 1.245192	 Test Loss: 1.171481
Epoch: 19 	 Train Loss: 0.013767	 Test Loss: 0.011841
Epoch: 24 	 Train Loss: 0.008913	 Test Loss: 0.009566
Epoch: 29 	 Train Loss: 0.008556	 Test Loss: 0.010119
Epoch: 34 	 Train Loss: 0.008796	 Test Loss: 0.009537
Epoch: 39 	 Train Loss: 0.008423	 Test Loss: 0.009179
Epoch: 44 	 Train Loss: 0.008499	 Test Loss: 0.009138
Epoch: 49 	 Train Loss: 0.008383	 Test Loss: 0.009138
Epoch: 54 	 Train Loss: 0.008400	 Test Loss: 0.009135
Epoch: 59 	 Train Loss: 0.008414	 Test Loss: 0.009135
Finished training MVAE for risk score prediction
Best test loss: 0.009118 at epoch: 42
Start evaluation

Evaluation of fine-tuned MVAE model

MAPE Score: 1.101135492324829

Finished
