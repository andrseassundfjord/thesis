Latent dimension: 64, Hidden dimension 512, Split size 4
Started: MAE, Augmented run
Using device: cuda
Model: MAE
Number of parameters in model:  395341241
torch.cuda.memory_allocated: 1.474929GB
torch.cuda.memory_reserved: 1.505859GB
torch.cuda.max_memory_reserved: 1.505859GB
Start training
Time taken: 2914.25 seconds
Epoch: 9 	 Train Loss: 124029.269313	 Test Loss: 114689.605864
Time taken: 5763.96 seconds
Epoch: 19 	 Train Loss: 104795.496004	 Test Loss: 100160.993827
Time taken: 8681.67 seconds
Epoch: 29 	 Train Loss: 97954.452251	 Test Loss: 100573.304321
Time taken: 11571.42 seconds
Epoch: 39 	 Train Loss: 94530.043154	 Test Loss: 94589.052932
Time taken: 14451.50 seconds
Epoch: 49 	 Train Loss: 91997.976825	 Test Loss: 93567.750463
Time taken: 17349.07 seconds
Epoch: 59 	 Train Loss: 89868.769845	 Test Loss: 89138.808410
Time taken: 20457.86 seconds
Epoch: 69 	 Train Loss: 87925.301412	 Test Loss: 86798.837963
Time taken: 23477.31 seconds
Epoch: 79 	 Train Loss: 86734.133657	 Test Loss: 85825.430941
Time taken: 26376.19 seconds
Epoch: 89 	 Train Loss: 85714.495205	 Test Loss: 85074.933488
Time taken: 29377.73 seconds
Epoch: 99 	 Train Loss: 84423.143380	 Test Loss: 84364.436343
Time taken: 32360.16 seconds
Epoch: 109 	 Train Loss: 84144.543953	 Test Loss: 84460.097762
Time taken: 35381.25 seconds
Epoch: 119 	 Train Loss: 83067.262653	 Test Loss: 83444.632330
Time taken: 38287.50 seconds
Epoch: 129 	 Train Loss: 82573.162160	 Test Loss: 83391.763889
Time taken: 41184.12 seconds
Epoch: 139 	 Train Loss: 82040.464571	 Test Loss: 82796.027315
Time taken: 43566.40 seconds
Epoch: 149 	 Train Loss: 80768.426145	 Test Loss: 82049.979321
Finished training
Time taken: 43566.40 seconds
Best test loss: 82049.979321 at epoch: 149
Timeseries loss: 3803.4174961419753
Video loss: 76430.34575617284, at epoch: 149
Timeseries MAPE: 2.482520
Video MAPE: 1.615824
Started
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results
ARI:          -0.00038                    -0.00001
Rand:         0.32082                    0.08243
FM:           0.24132                    0.28611 
Completeness: 0.02486                    0.26214 
Homogeneity:  0.00449                    0.00029 
V measure:    0.00761                    0.00058
Silhouette:   0.34005                    0.25293
CH Score:     1226.36203                 2.40136

Cluster  4
              K-means results      Spectral clustering results
ARI:          0.01519                    -0.00003
Rand:         0.70441                    0.08293
FM:           0.16181                    0.28600 
Completeness: 0.04731                    0.26213 
Homogeneity:  0.02531                    0.00058 
V measure:    0.03298                    0.00115
Silhouette:   0.10813                    0.21225
CH Score:     595.06842                 2.30689

Cluster  6
              K-means results      Spectral clustering results
ARI:          0.01863                    -0.00003
Rand:         0.76122                    0.08293
FM:           0.14377                    0.28600 
Completeness: 0.05469                    0.26213 
Homogeneity:  0.03626                    0.00058 
V measure:    0.04361                    0.00115
Silhouette:   0.10814                    0.21225
CH Score:     409.62029                 2.30689

Cluster  8
              K-means results      Spectral clustering results
ARI:          0.01744                    -0.00003
Rand:         0.80249                    0.08293
FM:           0.12425                    0.28600 
Completeness: 0.05262                    0.26213 
Homogeneity:  0.04123                    0.00058 
V measure:    0.04624                    0.00115
Silhouette:   0.06135                    0.21225
CH Score:     322.69997                 2.30689

Cluster  10
              K-means results      Spectral clustering results
ARI:          0.01763                    -0.00003
Rand:         0.81623                    0.08293
FM:           0.11774                    0.28600 
Completeness: 0.05811                    0.26213 
Homogeneity:  0.04931                    0.00058 
V measure:    0.05335                    0.00115
Silhouette:   0.05963                    0.21225
CH Score:     267.70032                 2.30689

Cluster  12
              K-means results      Spectral clustering results
ARI:          0.02033                    -0.00004
Rand:         0.84232                    0.08343
FM:           0.10659                    0.28589 
Completeness: 0.06166                    0.26224 
Homogeneity:  0.05825                    0.00087 
V measure:    0.05991                    0.00173
Silhouette:   0.04982                    0.15467
CH Score:     230.88236                 2.23019

Cluster  14
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:274: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:274: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:420: ConvergenceWarning: Number of distinct clusters (3) found smaller than n_clusters (4). Possibly due to duplicate points in X.
  est = KMeans(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:274: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 106 with accuracies 
[1.35833659e-15 5.34840105e-05 3.38328486e-05 4.52296381e-05
 1.07977714e-04 6.78144892e-05 4.48912138e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 87 instead with accuracy 
4.683963339421884e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:420: ConvergenceWarning: Number of distinct clusters (3) found smaller than n_clusters (6). Possibly due to duplicate points in X.
  est = KMeans(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:274: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 128 with accuracies 
[2.32691839e-15 4.57592647e-05 2.79251719e-05 2.48139831e-05
 4.67674341e-05 5.49313104e-05 6.49967180e-05 4.07899443e-05
 4.53896032e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 116 instead with accuracy 
3.8744761952240215e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:420: ConvergenceWarning: Number of distinct clusters (3) found smaller than n_clusters (8). Possibly due to duplicate points in X.
  est = KMeans(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:274: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 100 with accuracies 
[1.83304406e-15 2.57362423e-05 1.82893871e-05 2.65967857e-05
 2.82110761e-05 3.37505945e-05 4.22929393e-05 4.47620130e-05
 2.79464669e-05 5.12352368e-05 4.53067209e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 100 instead with accuracy 
3.12843147790557e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:420: ConvergenceWarning: Number of distinct clusters (3) found smaller than n_clusters (10). Possibly due to duplicate points in X.
  est = KMeans(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:274: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 96 with accuracies 
[3.94716414e-15 3.37909414e-05 4.32265812e-05 3.22932782e-05
 4.72856710e-05 2.73508097e-05 6.11239155e-05 3.08139596e-05
 3.99999274e-05 3.72286115e-05 4.94474788e-05 4.12190665e-05
 4.54804956e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 96 instead with accuracy 
3.7635441254314515e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:420: ConvergenceWarning: Number of distinct clusters (4) found smaller than n_clusters (12). Possibly due to duplicate points in X.
  est = KMeans(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:274: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 89 with accuracies 
[3.55399703e-15 2.09460933e-05 4.30686141e-05 3.18247085e-05
 3.77268661e-05 2.41028129e-05 3.21835384e-05 6.86065153e-05
 4.18787179e-05 5.22874537e-05 4.43679238e-05 3.64236266e-05
 4.81307410e-05 4.72290628e-05 4.79249251e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 88 instead with accuracy 
3.831219006579024e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:420: ConvergenceWarning: Number of distinct clusters (4) found smaller than n_clusters (14). Possibly due to duplicate points in X.
  est = KMeans(
              K-means results      Spectral clustering results
ARI:          0.02408                    0.00001
Rand:         0.85384                    0.08400
FM:           0.10364                    0.28589 
Completeness: 0.07038                    0.25065 
Homogeneity:  0.07083                    0.00106 
V measure:    0.07061                    0.00211
Silhouette:   0.04589                    0.15319
CH Score:     201.67524                 2.44750
Finished cluster for  MAE

Start classification fine-tuning
Traceback (most recent call last):
  File "run_MVAE_augmented.py", line 561, in <module>
    model_arg = MidMVAE
  File "/work6/a_sundfjord/thesis/feature_extraction/classification.py", line 71, in train_test_classification
    pretrained_model.load_state_dict(torch.load(f'augmented_models/{model_name}_state.pth'))
  File "/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1671, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for MAE:
	Missing key(s) in state_dict: "standard_decoder.embeddings.0.weight", "standard_decoder.embeddings.1.weight", "standard_decoder.embeddings.2.weight", "standard_decoder.embeddings.3.weight", "standard_decoder.embeddings.4.weight", "standard_decoder.embeddings.5.weight", "standard_decoder.embeddings.6.weight", "standard_decoder.embeddings.7.weight", "standard_decoder.embeddings.8.weight", "standard_decoder.embeddings.9.weight", "standard_decoder.embeddings.10.weight", "standard_decoder.embeddings.11.weight", "mcars_decoder.embeddings.0.weight", "mcars_decoder.embeddings.1.weight", "mcars_decoder.embeddings.2.weight", "mcars_decoder.embeddings.3.weight", "mcars_decoder.embeddings.4.weight", "mpeds_decoder.embeddings.0.weight". 
	size mismatch for standard_decoder.fc1.weight: copying a param with shape torch.Size([512, 128]) from checkpoint, the shape in current model is torch.Size([512, 176]).
	size mismatch for mcars_decoder.fc1.weight: copying a param with shape torch.Size([512, 128]) from checkpoint, the shape in current model is torch.Size([512, 148]).
	size mismatch for mpeds_decoder.fc1.weight: copying a param with shape torch.Size([512, 128]) from checkpoint, the shape in current model is torch.Size([512, 132]).
