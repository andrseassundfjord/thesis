Latent dimension: 64, Hidden dimension 512, Split size 4
Started: MVAE_triplet_loss, Augmented run
Using device: cuda
Model: MVAE
Number of parameters in model:  395208622
torch.cuda.memory_allocated: 1.474424GB
torch.cuda.memory_reserved: 1.503906GB
torch.cuda.max_memory_reserved: 1.503906GB
Start training
Time taken: 2347.33 seconds
Epoch: 9 	 Train Loss: 144225.941263	 Test Loss: 145650.863426
Time taken: 4707.15 seconds
Epoch: 19 	 Train Loss: 125199.733484	 Test Loss: 128105.116049
Time taken: 7008.77 seconds
Epoch: 29 	 Train Loss: 119568.374001	 Test Loss: 122876.911265
Time taken: 9360.96 seconds
Epoch: 39 	 Train Loss: 115418.645445	 Test Loss: 120464.611883
Time taken: 11658.54 seconds
Epoch: 49 	 Train Loss: 112921.318860	 Test Loss: 118210.337114
Time taken: 13946.92 seconds
Epoch: 59 	 Train Loss: 111030.713173	 Test Loss: 117065.099228
Time taken: 16197.74 seconds
Epoch: 69 	 Train Loss: 109481.883191	 Test Loss: 115876.167824
Time taken: 18453.04 seconds
Epoch: 79 	 Train Loss: 108167.495072	 Test Loss: 114706.683719
Time taken: 20714.17 seconds
Epoch: 89 	 Train Loss: 106915.618274	 Test Loss: 113644.076929
Time taken: 22945.26 seconds
Epoch: 99 	 Train Loss: 105800.867741	 Test Loss: 112804.663889
Time taken: 25214.46 seconds
Epoch: 109 	 Train Loss: 104754.901305	 Test Loss: 112868.703086
Time taken: 27470.31 seconds
Epoch: 119 	 Train Loss: 103997.866542	 Test Loss: 111561.387037
Time taken: 29704.55 seconds
Epoch: 129 	 Train Loss: 103034.950386	 Test Loss: 111345.655324
Time taken: 31941.79 seconds
Epoch: 139 	 Train Loss: 102275.770178	 Test Loss: 110665.875000
Time taken: 34180.83 seconds
Epoch: 149 	 Train Loss: 101530.728556	 Test Loss: 111049.245988
Finished training
Time taken: 34180.83 seconds
Best test loss: 110347.726080 at epoch: 148
Timeseries loss: 32631.008133198302
Video loss: 75956.40464891975, at epoch: 148
Timeseries MAPE: 2.693563
Video MAPE: 1.617238
Masked MAPE: 2.609411
Started
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results
ARI:          -0.00068                    0.00004
Rand:         0.30754                    0.08248
FM:           0.24352                    0.28621 
Completeness: 0.02863                    0.33151 
Homogeneity:  0.00496                    0.00036 
V measure:    0.00846                    0.00073
Silhouette:   0.31273                    0.39685
CH Score:     784.12287                 4.13991

Cluster  4
              K-means results      Spectral clustering results
ARI:          0.01729                    0.00003
Rand:         0.70176                    0.08402
FM:           0.16515                    0.28592 
Completeness: 0.05361                    0.25882 
Homogeneity:  0.02849                    0.00110 
V measure:    0.03721                    0.00218
Silhouette:   0.06987                    0.27550
CH Score:     395.54449                 3.90076

Cluster  6
              K-means results      Spectral clustering results
ARI:          0.01643                    0.00002
Rand:         0.75881                    0.08555
FM:           0.14241                    0.28564 
Completeness: 0.05255                    0.27080 
Homogeneity:  0.03473                    0.00199 
V measure:    0.04182                    0.00396
Silhouette:   0.06059                    0.21296
CH Score:     281.90581                 3.72592

Cluster  8
              K-means results      Spectral clustering results
ARI:          0.02343                    -0.00001
Rand:         0.80910                    0.08656
FM:           0.12719                    0.28542 
Completeness: 0.06633                    0.26898 
Homogeneity:  0.05285                    0.00257 
V measure:    0.05883                    0.00510
Silhouette:   0.05191                    0.20152
CH Score:     223.94405                 3.39152

Cluster  10
              K-means results      Spectral clustering results
ARI:          0.02382                    0.00004
Rand:         0.82764                    0.08711
FM:           0.11814                    0.28540 
Completeness: 0.07077                    0.27121 
Homogeneity:  0.06176                    0.00294 
V measure:    0.06596                    0.00581
Silhouette:   0.04669                    0.18147
CH Score:     185.25915                 2.98477

Cluster  12
              K-means results      Spectral clustering results
ARI:          0.02826                    0.00001
Rand:         0.84052                    0.08812
FM:           0.11558                    0.28518 
Completeness: 0.08078                    0.26970 
Homogeneity:  0.07567                    0.00351 
V measure:    0.07814                    0.00694
Silhouette:   0.04909                    0.13800
CH Score:     161.09091                 2.86378

Cluster  14
              K-means results      Spectral clustering results
ARI:          0.02692                    -0.00000
Rand:         0.85452                    0.08862
FM:           0.10611                    0.28507 
Completeness: 0.08088                    0.27767 
Homogeneity:  0.08157                    0.00397 
V measure:    0.08123                    0.00783
Silhouette:   0.04272                    0.17400
CH Score:     142.83991                 2.72036
Finished cluster for  MVAE

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.082973	 Test Loss: 0.084721
Epoch: 9 	 Train Loss: 0.082972	 Test Loss: 0.084719
Epoch: 14 	 Train Loss: 0.082941	 Test Loss: 0.084701
Epoch: 19 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 24 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 29 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 34 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 39 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 44 	 Train Loss: 0.082936	 Test Loss: 0.084699
Epoch: 49 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 54 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 59 	 Train Loss: 0.082937	 Test Loss: 0.084699
Finished training
Best test loss: 0.084699 at epoch: 24
Start evaluation

Evaluation of fine-tuned MVAE model

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
2 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
3 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
4 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
5 [  0 160   0   0   0   0   0   0   0   0   0   0   0   0]
6 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
7 [ 0 72  0  0  0  0  0  0  0  0  0  0  0  0]
8 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
9 [ 0 60  0  0  0  0  0  0  0  0  0  0  0  0]
10 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
11 [  0 300   0   0   0   0   0   0   0   0   0   0   0   0]
12 [  0 212   0   0   0   0   0   0   0   0   0   0   0   0]
13 [  0 108   0   0   0   0   0   0   0   0   0   0   0   0]
14 [  0 228   0   0   0   0   0   0   0   0   0   0   0   0]
F1 Score: 0.015693659761456372

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 1.229915	 Test Loss: 0.876262
Epoch: 9 	 Train Loss: 1.368724	 Test Loss: 1.454424
Epoch: 14 	 Train Loss: 0.016106	 Test Loss: 0.013408
Epoch: 19 	 Train Loss: 0.008774	 Test Loss: 0.009442
Epoch: 24 	 Train Loss: 0.008702	 Test Loss: 0.009367
Epoch: 29 	 Train Loss: 0.008571	 Test Loss: 0.009278
Epoch: 34 	 Train Loss: 0.008388	 Test Loss: 0.009138
Epoch: 39 	 Train Loss: 0.008405	 Test Loss: 0.009142
Epoch: 44 	 Train Loss: 0.008493	 Test Loss: 0.009133
Epoch: 49 	 Train Loss: 0.008381	 Test Loss: 0.009139
Epoch: 54 	 Train Loss: 0.008398	 Test Loss: 0.009137
Epoch: 59 	 Train Loss: 0.008413	 Test Loss: 0.009137
Finished training MVAE for risk score prediction
Best test loss: 0.009133 at epoch: 44
Start evaluation

Evaluation of fine-tuned MVAE model

MAPE Score: 1.0648847818374634

Finished

***
Exited at iteration warning for spectral
***
