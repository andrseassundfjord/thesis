Latent dimension: 64, Hidden dimension 512, Split size 4
Started: MVAE, Augmented run
Using device: cuda
Model: MVAE
Number of parameters in model:  395246138
torch.cuda.memory_allocated: 1.474571GB
torch.cuda.memory_reserved: 1.503906GB
torch.cuda.max_memory_reserved: 1.503906GB
Start training
Time taken: 3539.10 seconds
Epoch: 9 	 Train Loss: 228342.710442	 Test Loss: 223903.928704
Time taken: 6763.05 seconds
Epoch: 19 	 Train Loss: 224133.211774	 Test Loss: 219974.503704
Time taken: 9843.96 seconds
Epoch: 29 	 Train Loss: 221436.004529	 Test Loss: 219137.599383
Time taken: 12825.09 seconds
Epoch: 39 	 Train Loss: 220995.333511	 Test Loss: 223877.371605
Time taken: 15767.47 seconds
Epoch: 49 	 Train Loss: 219947.745605	 Test Loss: 217943.641667
Time taken: 18832.24 seconds
Epoch: 59 	 Train Loss: 133658.365876	 Test Loss: 127709.959414
Time taken: 21813.87 seconds
Epoch: 69 	 Train Loss: 99889.013519	 Test Loss: 99916.742361
Time taken: 24823.57 seconds
Epoch: 79 	 Train Loss: 91949.029169	 Test Loss: 93794.033333
Time taken: 28111.39 seconds
Epoch: 89 	 Train Loss: 87765.498601	 Test Loss: 91012.825386
Time taken: 31288.61 seconds
Epoch: 99 	 Train Loss: 85113.506660	 Test Loss: 88620.304012
Time taken: 34318.19 seconds
Epoch: 109 	 Train Loss: 82893.148974	 Test Loss: 87143.325540
Time taken: 37236.57 seconds
Epoch: 119 	 Train Loss: 80904.487480	 Test Loss: 85692.983025
Time taken: 39906.08 seconds
Epoch: 129 	 Train Loss: 79274.361681	 Test Loss: 84431.626543
Time taken: 42207.97 seconds
Epoch: 139 	 Train Loss: 78167.637587	 Test Loss: 84100.827006
Time taken: 44497.94 seconds
Epoch: 149 	 Train Loss: 76789.737480	 Test Loss: 83492.671528
Finished training
Time taken: 44497.94 seconds
Best test loss: 83244.762114 at epoch: 146
Timeseries loss: 3985.9155538676696
Video loss: 77475.35686728395, at epoch: 146
Timeseries MAPE: 2.568766
Video MAPE: 1.602347
Started
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results
ARI:          -0.00072                    0.00004
Rand:         0.30926                    0.08248
FM:           0.24312                    0.28621 
Completeness: 0.02692                    0.33151 
Homogeneity:  0.00469                    0.00036 
V measure:    0.00799                    0.00073
Silhouette:   0.29626                    0.41906
CH Score:     780.14818                 4.55846

Cluster  4
              K-means results      Spectral clustering results
ARI:          0.01888                    0.00006
Rand:         0.70010                    0.08404
FM:           0.16756                    0.28597 
Completeness: 0.05908                    0.30884 
Homogeneity:  0.03129                    0.00131 
V measure:    0.04091                    0.00260
Silhouette:   0.08057                    0.21839
CH Score:     416.03977                 3.83882

Cluster  6
              K-means results      Spectral clustering results
ARI:          0.01736                    0.00006
Rand:         0.76218                    0.08508
FM:           0.14201                    0.28580 
Completeness: 0.05447                    0.29813 
Homogeneity:  0.03637                    0.00192 
V measure:    0.04361                    0.00381
Silhouette:   0.06451                    0.20594
CH Score:     297.69602                 3.38375

Cluster  8
              K-means results      Spectral clustering results
ARI:          0.01947                    0.00001
Rand:         0.80763                    0.09171
FM:           0.12386                    0.28456 
Completeness: 0.05982                    0.28126 
Homogeneity:  0.04755                    0.00509 
V measure:    0.05298                    0.01001
Silhouette:   0.05772                    0.14454
CH Score:     235.41680                 5.30101

Cluster  10
              K-means results      Spectral clustering results
ARI:          0.02027                    0.00002
Rand:         0.82785                    0.09121
FM:           0.11444                    0.28467 
Completeness: 0.06080                    0.30836 
Homogeneity:  0.05327                    0.00552 
V measure:    0.05678                    0.01084
Silhouette:   0.04621                    0.10186
CH Score:     194.63903                 4.70155

Cluster  12
              K-means results      Spectral clustering results
ARI:          0.02431                    0.00003
Rand:         0.83984                    0.09224
FM:           0.11199                    0.28450 
Completeness: 0.07475                    0.30506 
Homogeneity:  0.06996                    0.00613 
V measure:    0.07227                    0.01201
Silhouette:   0.05039                    0.10052
CH Score:     168.25878                 4.32168

Cluster  14
              K-means results      Spectral clustering results
ARI:          0.02623                    -0.00007
Rand:         0.85794                    0.09574
FM:           0.10334                    0.28373 
Completeness: 0.07436                    0.28714 
Homogeneity:  0.07596                    0.00757 
V measure:    0.07515                    0.01475
Silhouette:   0.03953                    0.08779
CH Score:     148.40965                 4.42931
Finished cluster for  MVAE

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.082967	 Test Loss: 0.084715
Epoch: 9 	 Train Loss: 0.082940	 Test Loss: 0.084701
Epoch: 14 	 Train Loss: 0.082940	 Test Loss: 0.084700
Epoch: 19 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 24 	 Train Loss: 0.082936	 Test Loss: 0.084699
Epoch: 29 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 34 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 39 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 44 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 49 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 54 	 Train Loss: 0.082937	 Test Loss: 0.084699
Epoch: 59 	 Train Loss: 0.082937	 Test Loss: 0.084699
Finished training
Best test loss: 0.084699 at epoch: 17
Start evaluation

Evaluation of fine-tuned MVAE model

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
2 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
3 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
4 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
5 [  0   0   0   0   0   0   0   0   0   0 160   0   0   0]
6 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
7 [ 0  0  0  0  0  0  0  0  0  0 72  0  0  0]
8 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
9 [ 0  0  0  0  0  0  0  0  0  0 60  0  0  0]
10 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
11 [  0   0   0   0   0   0   0   0   0   0 300   0   0   0]
12 [  0   0   0   0   0   0   0   0   0   0 212   0   0   0]
13 [  0   0   0   0   0   0   0   0   0   0 108   0   0   0]
14 [  0   0   0   0   0   0   0   0   0   0 228   0   0   0]
F1 Score: 0.015693659761456372

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.602884	 Test Loss: 0.596015
Epoch: 9 	 Train Loss: 0.649905	 Test Loss: 0.836416
Epoch: 14 	 Train Loss: 0.516857	 Test Loss: 0.485339
Epoch: 19 	 Train Loss: 0.031445	 Test Loss: 0.018919
Epoch: 24 	 Train Loss: 0.009608	 Test Loss: 0.010085
Epoch: 29 	 Train Loss: 0.008711	 Test Loss: 0.009456
Epoch: 34 	 Train Loss: 0.008541	 Test Loss: 0.009229
Epoch: 39 	 Train Loss: 0.008400	 Test Loss: 0.009127
Epoch: 44 	 Train Loss: 0.008396	 Test Loss: 0.009132
Epoch: 49 	 Train Loss: 0.008419	 Test Loss: 0.009135
Epoch: 54 	 Train Loss: 0.008375	 Test Loss: 0.009135
Epoch: 59 	 Train Loss: 0.008380	 Test Loss: 0.009135
Finished training MVAE for risk score prediction
Best test loss: 0.009127 at epoch: 41
Start evaluation
Evaluation of fine-tuned MVAE model

MAPE Score: 0.9908060431480408

Finished

***
Exited at iteration for spectral
***