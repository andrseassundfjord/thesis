Latent dimension: 2048, Hidden dimension 512, Split size 4
Started: MVAE2048, Augmented run
Using device: cuda
Model: MVAE
Number of parameters in model:  434471982
torch.cuda.memory_allocated: 1.619452GB
torch.cuda.memory_reserved: 1.646484GB
torch.cuda.max_memory_reserved: 1.646484GB
Start training
Time taken: 2180.18 seconds
Epoch: 9 	 Train Loss: 190185.242009	 Test Loss: 182914.327160
Time taken: 4322.40 seconds
Epoch: 19 	 Train Loss: 134541.978023	 Test Loss: 133637.882099
Time taken: 6458.73 seconds
Epoch: 29 	 Train Loss: 122180.038359	 Test Loss: 123007.380401
Time taken: 8571.24 seconds
Epoch: 39 	 Train Loss: 115729.128996	 Test Loss: 117549.998380
Time taken: 10709.54 seconds
Epoch: 49 	 Train Loss: 111864.906633	 Test Loss: 114497.113503
Time taken: 12854.59 seconds
Epoch: 59 	 Train Loss: 109275.810802	 Test Loss: 112255.873920
Time taken: 15008.83 seconds
Epoch: 69 	 Train Loss: 107149.581513	 Test Loss: 110370.479861
Time taken: 17137.32 seconds
Epoch: 79 	 Train Loss: 105513.006660	 Test Loss: 109335.760262
Time taken: 19268.78 seconds
Epoch: 89 	 Train Loss: 104040.050147	 Test Loss: 107898.368364
Time taken: 21388.99 seconds
Epoch: 99 	 Train Loss: 102656.861414	 Test Loss: 107051.914352
Time taken: 23523.99 seconds
Epoch: 109 	 Train Loss: 101382.527304	 Test Loss: 105968.580093
Time taken: 25644.57 seconds
Epoch: 119 	 Train Loss: 100310.331180	 Test Loss: 105459.664738
Time taken: 27758.02 seconds
Epoch: 129 	 Train Loss: 99354.967102	 Test Loss: 104390.586960
Time taken: 29872.41 seconds
Epoch: 139 	 Train Loss: 98505.399707	 Test Loss: 103968.426312
Time taken: 31971.35 seconds
Epoch: 149 	 Train Loss: 97725.323855	 Test Loss: 103443.832330
Finished training
Time taken: 31971.35 seconds
Best test loss: 103436.261420 at epoch: 147
Timeseries loss: 32472.248902874227
Video loss: 69022.84311342593, at epoch: 147
Timeseries MAPE: 2.667500
Video MAPE: 2.230942
Masked MAPE: nan
Run Cluster
Started Cluster task
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results       GMM results
ARI:          -0.00067                    0.00000                  -0.00067
Rand:         0.31654                    0.00000                    0.31654
FM:           0.24173                    0.00000                    0.24173
Completeness: 0.02784                    0.00000                    0.02784
Homogeneity:  0.00497                    0.00000                    0.00497
V measure:    0.00843                    0.00000                    0.00843
Silhouette:   0.20402                    0.00000                    0.20402
CH Score:     388.71369                 0.00000                    388.71369

Cluster  4

              K-means results      Spectral clustering results       GMM results
ARI:          0.01688                    0.00000                  0.01327
Rand:         0.70526                    0.00000                    0.69587
FM:           0.16342                    0.00000                    0.16264
Completeness: 0.05052                    0.00000                    0.04188
Homogeneity:  0.02702                    0.00000                    0.02211
V measure:    0.03521                    0.00000                    0.02894
Silhouette:   0.03648                    0.00000                    0.05295
CH Score:     216.29054                 0.00000                    214.91405

Cluster  6

              K-means results      Spectral clustering results       GMM results
ARI:          0.02155                    0.00000                  0.01866
Rand:         0.76307                    0.00000                    0.76214
FM:           0.14612                    0.00000                    0.14342
Completeness: 0.06149                    0.00000                    0.06092
Homogeneity:  0.04109                    0.00000                    0.04070
V measure:    0.04926                    0.00000                    0.04880
Silhouette:   0.03186                    0.00000                    0.02738
CH Score:     152.75589                 0.00000                    152.09330

Cluster  8

              K-means results      Spectral clustering results       GMM results
ARI:          0.02438                    0.00000                  0.02134
Rand:         0.80704                    0.00000                    0.79536
FM:           0.12917                    0.00000                    0.13161
Completeness: 0.06571                    0.00000                    0.06009
Homogeneity:  0.05202                    0.00000                    0.04612
V measure:    0.05807                    0.00000                    0.05218
Silhouette:   0.02208                    0.00000                    0.02825
CH Score:     122.50747                 0.00000                    120.42707

Cluster  10

              K-means results      Spectral clustering results       GMM results
ARI:          0.02286                    0.00000                  0.02149
Rand:         0.81735                    0.00000                    0.82529
FM:           0.12249                    0.00000                    0.11702
Completeness: 0.06918                    0.00000                    0.06464
Homogeneity:  0.05851                    0.00000                    0.05629
V measure:    0.06340                    0.00000                    0.06017
Silhouette:   0.02647                    0.00000                    0.01875
CH Score:     101.74113                 0.00000                    101.63832

Cluster  12

              K-means results      Spectral clustering results       GMM results
ARI:          0.02492                    0.00000                  0.02266
Rand:         0.83814                    0.00000                    0.82359
FM:           0.11355                    0.00000                    0.11909
Completeness: 0.07150                    0.00000                    0.07688
Homogeneity:  0.06648                    0.00000                    0.06772
V measure:    0.06890                    0.00000                    0.07201
Silhouette:   0.01913                    0.00000                    0.02367
CH Score:     88.26269                 0.00000                    86.25472

Cluster  14
              K-means results      Spectral clustering results       GMM results
ARI:          0.02184                    0.00000                  0.02405
Rand:         0.85316                    0.00000                    0.84627
FM:           0.10180                    0.00000                    0.10808
Completeness: 0.06835                    0.00000                    0.07899
Homogeneity:  0.06855                    0.00000                    0.07766
V measure:    0.06845                    0.00000                    0.07832
Silhouette:   0.00275                    0.00000                    0.01581
CH Score:     77.92853                 0.00000                    77.28630
Finished cluster for  MVAE

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.301075	 Test Loss: 0.446533
Epoch: 9 	 Train Loss: 0.305730	 Test Loss: 0.339469
Epoch: 14 	 Train Loss: 0.124761	 Test Loss: 0.213296
Epoch: 19 	 Train Loss: 0.106434	 Test Loss: 0.196669
Epoch: 24 	 Train Loss: 0.098807	 Test Loss: 0.189394
Epoch: 29 	 Train Loss: 0.093301	 Test Loss: 0.184225
Epoch: 34 	 Train Loss: 0.089808	 Test Loss: 0.181568
Epoch: 39 	 Train Loss: 0.086095	 Test Loss: 0.177471
Epoch: 44 	 Train Loss: 0.084093	 Test Loss: 0.174926
Epoch: 49 	 Train Loss: 0.081684	 Test Loss: 0.176033
Epoch: 54 	 Train Loss: 0.080100	 Test Loss: 0.171056
Epoch: 59 	 Train Loss: 0.078687	 Test Loss: 0.170447
Epoch: 64 	 Train Loss: 0.078500	 Test Loss: 0.170545
Epoch: 69 	 Train Loss: 0.078423	 Test Loss: 0.170492
Epoch: 74 	 Train Loss: 0.078384	 Test Loss: 0.170493
Epoch: 79 	 Train Loss: 0.078411	 Test Loss: 0.170490
Finished training
Best test loss: 0.170348 at epoch: 57
Start evaluation

Evaluation of fine-tuned MVAE model

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [  0   5  29   0   0   0  40   0 226   0   0   0   0   0]
2 [  0   4  35   0   0   0  51   0 210   0   0   0   0   0]
3 [  0   1  15   0   0   0  32   0 252   0   0   0   0   0]
4 [  0   6  54   0   0   0  29   0 211   0   0   0   0   0]
5 [  0   6  37   0   0   0  10   0 107   0   0   0   0   0]
6 [  0   9  31   0   0   0  57   0 203   0   0   0   0   0]
7 [ 0  2  7  0  0  0  4  0 59  0  0  0  0  0]
8 [  0   9  39   0   0   0  39   0 213   0   0   0   0   0]
9 [ 0  0  1  0  0  0  3  0 56  0  0  0  0  0]
10 [  0   6  41   0   0   0  52   0 201   0   0   0   0   0]
11 [  0   1  55   0   0   0  32   0 212   0   0   0   0   0]
12 [  0   3  27   0   0   0  13   0 169   0   0   0   0   0]
13 [ 0  2 12  0  0  0 24  0 70  0  0  0  0  0]
14 [  0   5  30   0   0   0  45   0 148   0   0   0   0   0]
F1 Score: 0.007177960268995561

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 1.136409	 Test Loss: 0.828010
Epoch: 9 	 Train Loss: 4.113288	 Test Loss: 1.516075
Epoch: 14 	 Train Loss: 1.526290	 Test Loss: 3.987158
Epoch: 19 	 Train Loss: 1.316128	 Test Loss: 1.324597
Epoch: 24 	 Train Loss: 1.217565	 Test Loss: 1.237474
Epoch: 29 	 Train Loss: 1.204594	 Test Loss: 1.225738
Epoch: 34 	 Train Loss: 1.203723	 Test Loss: 1.224042
Epoch: 39 	 Train Loss: 1.203036	 Test Loss: 1.223842
Epoch: 44 	 Train Loss: 1.202935	 Test Loss: 1.223776
Epoch: 49 	 Train Loss: 1.202904	 Test Loss: 1.223765
Epoch: 54 	 Train Loss: 1.202842	 Test Loss: 1.223765
Epoch: 59 	 Train Loss: 1.203333	 Test Loss: 1.223764
Epoch: 64 	 Train Loss: 1.202824	 Test Loss: 1.223763
Epoch: 69 	 Train Loss: 1.203082	 Test Loss: 1.223762
Epoch: 74 	 Train Loss: 1.202541	 Test Loss: 1.223761
Epoch: 79 	 Train Loss: 1.203003	 Test Loss: 1.223758
Finished training MVAE for risk score prediction
Best test loss: 0.828010 at epoch: 4
Start evaluation

Evaluation of fine-tuned MVAE model

MAPE Score: 69.114990234375