Latent dimension: 64, Hidden dimension 512, Split size 4
Started: VideoAE_triplet, Augmented run
Using device: cuda
Model: VideoAutoencoder
Number of parameters in model:  289787203
torch.cuda.memory_allocated: 1.079546GB
torch.cuda.memory_reserved: 1.083984GB
torch.cuda.max_memory_reserved: 1.083984GB
Start training
Time taken: 1347.53 seconds
Epoch: 9 	 Train Loss: 115378.026505	 Test Loss: 109478.882870
Time taken: 2671.53 seconds
Epoch: 19 	 Train Loss: 96773.914025	 Test Loss: 94321.321142
Time taken: 4000.96 seconds
Epoch: 29 	 Train Loss: 91157.950320	 Test Loss: 88856.937886
Time taken: 5324.32 seconds
Epoch: 39 	 Train Loss: 88240.706313	 Test Loss: 88285.892670
Time taken: 6603.47 seconds
Epoch: 49 	 Train Loss: 84975.664225	 Test Loss: 84477.039120
Time taken: 7858.85 seconds
Epoch: 59 	 Train Loss: 83629.795818	 Test Loss: 82810.186497
Time taken: 9120.67 seconds
Epoch: 69 	 Train Loss: 82338.315663	 Test Loss: 82139.185571
Time taken: 10370.92 seconds
Epoch: 79 	 Train Loss: 81328.509656	 Test Loss: 81742.494290
Time taken: 11628.53 seconds
Epoch: 89 	 Train Loss: 80168.188932	 Test Loss: 80862.742361
Time taken: 12875.99 seconds
Epoch: 99 	 Train Loss: 79210.433937	 Test Loss: 80403.315123
Time taken: 14589.65 seconds
Epoch: 109 	 Train Loss: 78361.921617	 Test Loss: 80116.172608
Time taken: 16424.48 seconds
Epoch: 119 	 Train Loss: 77677.960908	 Test Loss: 79028.477469
Time taken: 18272.80 seconds
Epoch: 129 	 Train Loss: 77174.323322	 Test Loss: 79422.535108
Time taken: 20110.79 seconds
Epoch: 139 	 Train Loss: 76280.184137	 Test Loss: 78652.243519
Time taken: 21954.28 seconds
Epoch: 149 	 Train Loss: 75719.928942	 Test Loss: 78097.293904
Finished training
Time taken: 21954.28 seconds
Best test loss: 78097.293904 at epoch: 149
Video loss: 76405.29677854938, at epoch: 149
Timeseries MAPE: 0.000000
Video MAPE: 1.605065
Masked MAPE: 0.000000
Started
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results
ARI:          -0.00032                    0.00004
Rand:         0.31679                    0.08248
FM:           0.24223                    0.28621 
Completeness: 0.03104                    0.33151 
Homogeneity:  0.00554                    0.00036 
V measure:    0.00940                    0.00073
Silhouette:   0.31631                    0.35220
CH Score:     1059.28260                 3.53821

Cluster  4
              K-means results      Spectral clustering results
ARI:          0.01254                    0.00002
Rand:         0.69039                    0.08452
FM:           0.16370                    0.28581 
Completeness: 0.04611                    0.25899 
Homogeneity:  0.02413                    0.00132 
V measure:    0.03168                    0.00263
Silhouette:   0.12029                    0.25854
CH Score:     545.66670                 4.16754

Cluster  6
              K-means results      Spectral clustering results
ARI:          0.01916                    0.00006
Rand:         0.78199                    0.08559
FM:           0.13542                    0.28570 
Completeness: 0.04795                    0.25378 
Homogeneity:  0.03363                    0.00187 
V measure:    0.03954                    0.00371
Silhouette:   0.09756                    0.21700
CH Score:     371.91260                 3.47834

Cluster  8
              K-means results      Spectral clustering results
ARI:          0.01958                    0.00004
Rand:         0.80932                    0.08609
FM:           0.12315                    0.28559 
Completeness: 0.05966                    0.26948 
Homogeneity:  0.04770                    0.00233 
V measure:    0.05302                    0.00461
Silhouette:   0.05580                    0.17296
CH Score:     293.27676                 2.90573

Cluster  10
              K-means results      Spectral clustering results
ARI:          0.02195                    0.00009
Rand:         0.83478                    0.08768
FM:           0.11241                    0.28540 
Completeness: 0.06075                    0.26640 
Homogeneity:  0.05438                    0.00313 
V measure:    0.05739                    0.00620
Silhouette:   0.04707                    0.14254
CH Score:     241.90970                 2.85663

Cluster  12
              K-means results      Spectral clustering results
ARI:          0.02255                    0.00007
Rand:         0.84435                    0.08868
FM:           0.10767                    0.28518 
Completeness: 0.06718                    0.27786 
Homogeneity:  0.06390                    0.00388 
V measure:    0.06550                    0.00765
Silhouette:   0.04599                    0.12007
CH Score:     209.96389                 2.79115

Cluster  14
              K-means results      Spectral clustering results
ARI:          0.02594                    0.00001
Rand:         0.85328                    0.09069
FM:           0.10586                    0.28474 
Completeness: 0.07698                    0.28023 
Homogeneity:  0.07724                    0.00503 
V measure:    0.07711                    0.00989
Silhouette:   0.04839                    0.11554
CH Score:     184.92475                 3.03651
Finished cluster for  VideoAutoencoder

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.092167	 Test Loss: 0.095481
Epoch: 9 	 Train Loss: 0.091097	 Test Loss: 0.091115
Epoch: 14 	 Train Loss: 0.094384	 Test Loss: 0.094601
Epoch: 19 	 Train Loss: 0.082957	 Test Loss: 0.084694
Epoch: 24 	 Train Loss: 0.082911	 Test Loss: 0.084673
Epoch: 29 	 Train Loss: 0.082925	 Test Loss: 0.084686
Epoch: 34 	 Train Loss: 0.082877	 Test Loss: 0.084659
Epoch: 39 	 Train Loss: 0.082864	 Test Loss: 0.084659
Epoch: 44 	 Train Loss: 0.082851	 Test Loss: 0.084660
Epoch: 49 	 Train Loss: 0.082857	 Test Loss: 0.084660
Epoch: 54 	 Train Loss: 0.082852	 Test Loss: 0.084660
Epoch: 59 	 Train Loss: 0.082852	 Test Loss: 0.084660
Finished training
Best test loss: 0.084658 at epoch: 35
Start evaluation

Evaluation of fine-tuned VideoAutoencoder model

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [  0   0 300   0   0   0   0   0   0   0   0   0   0   0]
2 [  0   0 300   0   0   0   0   0   0   0   0   0   0   0]
3 [  0   0 300   0   0   0   0   0   0   0   0   0   0   0]
4 [  0   0 298   2   0   0   0   0   0   0   0   0   0   0]
5 [  0   0 160   0   0   0   0   0   0   0   0   0   0   0]
6 [  0   0 300   0   0   0   0   0   0   0   0   0   0   0]
7 [ 0  0 72  0  0  0  0  0  0  0  0  0  0  0]
8 [  0   0 300   0   0   0   0   0   0   0   0   0   0   0]
9 [ 0  0 60  0  0  0  0  0  0  0  0  0  0  0]
10 [  0   0 300   0   0   0   0   0   0   0   0   0   0   0]
11 [  0   0 300   0   0   0   0   0   0   0   0   0   0   0]
12 [  0   0 212   0   0   0   0   0   0   0   0   0   0   0]
13 [  0   0 107   1   0   0   0   0   0   0   0   0   0   0]
14 [  0   0 226   2   0   0   0   0   0   0   0   0   0   0]
F1 Score: 0.01693018638319726

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.942476	 Test Loss: 1.522990
Epoch: 9 	 Train Loss: 0.877663	 Test Loss: 0.886786
Epoch: 14 	 Train Loss: 0.839530	 Test Loss: 0.849647
Epoch: 19 	 Train Loss: 0.834425	 Test Loss: 0.846669
Epoch: 24 	 Train Loss: 0.830914	 Test Loss: 0.843345
Epoch: 29 	 Train Loss: 0.827207	 Test Loss: 0.839783
Epoch: 34 	 Train Loss: 0.823349	 Test Loss: 0.836089
Epoch: 39 	 Train Loss: 0.819981	 Test Loss: 0.832352
Epoch: 44 	 Train Loss: 0.816232	 Test Loss: 0.828556
Epoch: 49 	 Train Loss: 0.373112	 Test Loss: 0.050965
Epoch: 54 	 Train Loss: 0.024830	 Test Loss: 0.024920
Epoch: 59 	 Train Loss: 0.022986	 Test Loss: 0.023560
Finished training VideoAutoencoder for risk score prediction
Best test loss: 0.023560 at epoch: 59
Start evaluation

MAPE Score: 2.395742893218994

Finished


***
Exited at iteration for Spectral
***