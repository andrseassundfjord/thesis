Latent dimension: 64, Hidden dimension 1024, Split size 4
Started: MidMVAE_maxpool, Augmented run
Using device: cuda
Model: MidMVAE
Number of parameters in model:  501020635
torch.cuda.memory_allocated: 1.866461GB
torch.cuda.memory_reserved: 1.867188GB
torch.cuda.max_memory_reserved: 1.867188GB
Start training
Time taken: 2822.57 seconds
Epoch: 9 	 Train Loss: 260510.899574	 Test Loss: 259905.258951
Time taken: 5562.30 seconds
Epoch: 19 	 Train Loss: 257809.718966	 Test Loss: 260790.866358
Time taken: 8337.35 seconds
Epoch: 29 	 Train Loss: 256496.348428	 Test Loss: 258426.708642
Time taken: 11114.47 seconds
Epoch: 39 	 Train Loss: 255873.428876	 Test Loss: 258950.593519
Time taken: 13907.20 seconds
Epoch: 49 	 Train Loss: 255399.742941	 Test Loss: 256372.927160
Time taken: 16664.28 seconds
Epoch: 59 	 Train Loss: 255062.851092	 Test Loss: 256724.390123
Time taken: 19438.42 seconds
Epoch: 69 	 Train Loss: 254717.745605	 Test Loss: 253698.891667
Time taken: 22218.21 seconds
Epoch: 79 	 Train Loss: 254434.030634	 Test Loss: 253953.970370
Finished training
Time taken: 22218.21 seconds
Best test loss: 252629.640123 at epoch: 78
Timeseries loss: 38243.85372299383
Video loss: 212996.8587962963, at epoch: 78
Timeseries MAPE: 2.946837
Video MAPE: 5.614665
Masked MAPE: nan
Started Cluster task
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results       GMM results
ARI:          0.00399                    0.00000                  0.00655
Rand:         0.34054                    0.00000                    0.36323
FM:           0.24396                    0.00000                    0.24301
Completeness: 0.03887                    0.00000                    0.07241
Homogeneity:  0.00738                    0.00000                    0.01459
V measure:    0.01241                    0.00000                    0.02428
Silhouette:   0.43219                    0.00000                    0.40874
CH Score:     1110.33700                 0.00000                    820.15017

Cluster  4
              K-means results      Spectral clustering results       GMM results
ARI:          0.01199                    0.01533                  0.00755
Rand:         0.64333                    0.58596                    0.45456
FM:           0.17845                    0.19982                    0.22374
Completeness: 0.05017                    0.07104                    0.06673
Homogeneity:  0.02408                    0.03125                    0.02283
V measure:    0.03254                    0.04341                    0.03402
Silhouette:   0.40067                    0.40088                    0.40269
CH Score:     1362.97100                 1215.22478                    718.14202

Cluster  6
              K-means results      Spectral clustering results       GMM results
ARI:          0.02071                    0.01897                  0.02028
Rand:         0.74801                    0.64866                    0.74099
FM:           0.15142                    0.18515                    0.15375
Completeness: 0.06125                    0.07391                    0.06155
Homogeneity:  0.04048                    0.03958                    0.03976
V measure:    0.04874                    0.05155                    0.04831
Silhouette:   0.47547                    0.36147                    0.38912
CH Score:     1250.64146                 842.16355                    864.46248

Cluster  8
              K-means results      Spectral clustering results       GMM results
ARI:          0.02014                    0.02129                  0.01547
Rand:         0.76083                    0.76736                    0.70432
FM:           0.14554                    0.14402                    0.16216
Completeness: 0.06416                    0.06608                    0.06329
Homogeneity:  0.04664                    0.04820                    0.04171
V measure:    0.05401                    0.05574                    0.05028
Silhouette:   0.50442                    0.42984                    0.46174
CH Score:     1265.37473                 860.49952                    941.16657

Cluster  10
              K-means results      Spectral clustering results       GMM results
ARI:          0.02098                    0.02071                  0.01939
Rand:         0.77219                    0.78612                    0.76525
FM:           0.14162                    0.13519                    0.14289
Completeness: 0.06407                    0.06282                    0.06754
Homogeneity:  0.04958                    0.05064                    0.05171
V measure:    0.05590                    0.05607                    0.05858
Silhouette:   0.52907                    0.41610                    0.47202
CH Score:     1174.63905                 655.52032                    814.86615

Cluster  12
              K-means results      Spectral clustering results       GMM results
ARI:          0.02016                    0.02312                  0.02131
Rand:         0.79347                    0.81815                    0.77298
FM:           0.13127                    0.12235                    0.14163
Completeness: 0.06372                    0.06631                    0.06832
Homogeneity:  0.05397                    0.05969                    0.05499
V measure:    0.05844                    0.06283                    0.06093
Silhouette:   0.54855                    0.42086                    0.52431
CH Score:     1125.51280                 506.02928                    916.57667

Cluster  14
              K-means results      Spectral clustering results       GMM results
ARI:          0.01999                    0.02139                  0.02190
Rand:         0.78024                    0.80652                    0.77978
FM:           0.13707                    0.12636                    0.13927
Completeness: 0.06977                    0.06988                    0.07292
Homogeneity:  0.05949                    0.06225                    0.06084
V measure:    0.06422                    0.06584                    0.06634
Silhouette:   0.55753                    0.35178                    0.53570
CH Score:     1119.96796                 355.12322                    806.41110
Finished cluster for  MidMVAE
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [ 22  24  39   1   0 154   0   2   0  42  16   0   0   0]
2 [ 15  17  50   2   0 122   0   5   0  70  19   0   0   0]
3 [ 11  20  66   2   0 152   0   4   0  34  11   0   0   0]
4 [ 16  12  47   1   0 163   0   3   0  11  47   0   0   0]
5 [20  8 42  1  0 41  0 13  0 13 22  0  0  0]
6 [ 26  14  37   2   0 128   0  20   0  43  30   0   0   0]
7 [ 4  2 14  0  0 33  0  3  0 14  2  0  0  0]
8 [  6  27  43   1   0 168   0   4   0  43   8   0   0   0]
9 [ 1  8 11  1  0 34  0  0  0  4  1  0  0  0]
10 [ 12  18  42   6   0 149   0   9   0  29  35   0   0   0]
11 [ 21   9  33   0   0 163   0   8   0  54  12   0   0   0]
12 [ 12  13  41   0   0 108   0   1   0  29   8   0   0   0]
13 [ 5 11 18  2  0 41  0  2  0 15 14  0  0  0]
14 [  3  30  27   6   0 122   0   6   0  19  15   0   0   0]
F1 Score: 0.05653597009269077
Finished GMM Classification for  MidMVAE
lr: 0.1, hidden_dim: 1024

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.086088	 Test Loss: 0.095567
Epoch: 9 	 Train Loss: 0.089157	 Test Loss: 0.092164
Epoch: 14 	 Train Loss: 0.079696	 Test Loss: 0.083901
Epoch: 19 	 Train Loss: 0.079586	 Test Loss: 0.084098
Epoch: 24 	 Train Loss: 0.079502	 Test Loss: 0.084156
Epoch: 29 	 Train Loss: 0.079473	 Test Loss: 0.084143
Epoch: 34 	 Train Loss: 0.079480	 Test Loss: 0.084145
Epoch: 39 	 Train Loss: 0.079486	 Test Loss: 0.084145
Epoch: 44 	 Train Loss: 0.079463	 Test Loss: 0.084145
Epoch: 49 	 Train Loss: 0.079468	 Test Loss: 0.084145
Epoch: 54 	 Train Loss: 0.079472	 Test Loss: 0.084145
Epoch: 59 	 Train Loss: 0.079478	 Test Loss: 0.084145
Epoch: 64 	 Train Loss: 0.079473	 Test Loss: 0.084145
Epoch: 69 	 Train Loss: 0.079481	 Test Loss: 0.084145
Epoch: 74 	 Train Loss: 0.079465	 Test Loss: 0.084145
Epoch: 79 	 Train Loss: 0.079481	 Test Loss: 0.084145
Finished training
Best test loss: 0.083887 at epoch: 15
Start evaluation

Evaluation of fine-tuned MidMVAE model

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [  0   0   0   0 300   0   0   0   0   0   0   0   0   0]
2 [  0   0   0   0 300   0   0   0   0   0   0   0   0   0]
3 [  0   0   0   0 300   0   0   0   0   0   0   0   0   0]
4 [  0   0   0   0 300   0   0   0   0   0   0   0   0   0]
5 [  0   0   0   0 160   0   0   0   0   0   0   0   0   0]
6 [  0   0   0   0 300   0   0   0   0   0   0   0   0   0]
7 [ 0  0  0  0 72  0  0  0  0  0  0  0  0  0]
8 [  0   0   0   0 300   0   0   0   0   0   0   0   0   0]
9 [ 0  0  0  0 60  0  0  0  0  0  0  0  0  0]
10 [  0   0   0   0 300   0   0   0   0   0   0   0   0   0]
11 [  0   0   0   0 300   0   0   0   0   0   0   0   0   0]
12 [  0   0   0   0 212   0   0   0   0   0   0   0   0   0]
13 [  0   0   0   0 108   0   0   0   0   0   0   0   0   0]
14 [  0   0   0   0 228   0   0   0   0   0   0   0   0   0]
F1 Score: 0.004647785039941903

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.009833	 Test Loss: 0.011950
Epoch: 9 	 Train Loss: 0.013013	 Test Loss: 0.014018
Epoch: 14 	 Train Loss: 0.257924	 Test Loss: 0.130291
Epoch: 19 	 Train Loss: 0.026432	 Test Loss: 0.024381
Epoch: 24 	 Train Loss: 0.020951	 Test Loss: 0.021707
Epoch: 29 	 Train Loss: 0.020007	 Test Loss: 0.020972
Epoch: 34 	 Train Loss: 0.019853	 Test Loss: 0.020833
Epoch: 39 	 Train Loss: 0.019854	 Test Loss: 0.020810
Epoch: 44 	 Train Loss: 0.019818	 Test Loss: 0.020807
Epoch: 49 	 Train Loss: 0.019830	 Test Loss: 0.020806
Epoch: 54 	 Train Loss: 0.019830	 Test Loss: 0.020806
Epoch: 59 	 Train Loss: 0.019846	 Test Loss: 0.020806
Epoch: 64 	 Train Loss: 0.019833	 Test Loss: 0.020806
Epoch: 69 	 Train Loss: 0.019799	 Test Loss: 0.020806
Epoch: 74 	 Train Loss: 0.019826	 Test Loss: 0.020806
Epoch: 79 	 Train Loss: 0.019809	 Test Loss: 0.020806
Finished training MidMVAE for risk score prediction
Best test loss: 0.010178 at epoch: 7
Start evaluation

Evaluation of fine-tuned MidMVAE model

MAPE Score: 1.5320332050323486

Finished
