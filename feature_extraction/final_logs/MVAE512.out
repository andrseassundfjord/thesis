Latent dimension: 512, Hidden dimension 512, Split size 4
Started: MVAE512, Augmented run
Using device: cuda
Model: MVAE
Number of parameters in model:  400633902
torch.cuda.memory_allocated: 1.494633GB
torch.cuda.memory_reserved: 1.533203GB
torch.cuda.max_memory_reserved: 1.533203GB
Start training
Time taken: 2156.68 seconds
Epoch: 9 	 Train Loss: 253103.950986	 Test Loss: 249980.838272
Time taken: 4306.48 seconds
Epoch: 19 	 Train Loss: 139816.520511	 Test Loss: 137586.560031
Time taken: 6455.92 seconds
Epoch: 29 	 Train Loss: 122087.549547	 Test Loss: 123097.452238
Time taken: 8615.70 seconds
Epoch: 39 	 Train Loss: 115845.323522	 Test Loss: 117880.093210
Time taken: 10753.65 seconds
Epoch: 49 	 Train Loss: 112204.590437	 Test Loss: 115014.835880
Time taken: 12895.51 seconds
Epoch: 59 	 Train Loss: 109684.632658	 Test Loss: 113195.984799
Time taken: 15025.87 seconds
Epoch: 69 	 Train Loss: 107785.286628	 Test Loss: 111559.249691
Time taken: 17143.73 seconds
Epoch: 79 	 Train Loss: 106203.033165	 Test Loss: 110053.414506
Time taken: 19262.11 seconds
Epoch: 89 	 Train Loss: 104794.553676	 Test Loss: 109119.642130
Time taken: 21373.18 seconds
Epoch: 99 	 Train Loss: 103545.929941	 Test Loss: 108001.805170
Time taken: 23470.53 seconds
Epoch: 109 	 Train Loss: 102359.821923	 Test Loss: 107309.920525
Time taken: 25585.84 seconds
Epoch: 119 	 Train Loss: 101268.971497	 Test Loss: 106134.919367
Time taken: 27666.21 seconds
Epoch: 129 	 Train Loss: 100253.648375	 Test Loss: 105535.815664
Time taken: 29748.77 seconds
Epoch: 139 	 Train Loss: 99363.341103	 Test Loss: 105190.635340
Time taken: 31845.28 seconds
Epoch: 149 	 Train Loss: 98549.367208	 Test Loss: 104511.038966
Finished training
Time taken: 31845.28 seconds
Best test loss: 104511.038966 at epoch: 149
Timeseries loss: 32457.485093557098
Video loss: 70184.52455632716, at epoch: 149
Timeseries MAPE: 2.671263
Video MAPE: 2.264404
Masked MAPE: nan
Started Cluster task
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results       GMM results
ARI:          -0.00071                    0.00002                  -0.00065
Rand:         0.31101                    0.08245                    0.31209
FM:           0.24279                    0.28616                    0.24266
Completeness: 0.02938                    0.29241                    0.02947
Homogeneity:  0.00515                    0.00032                    0.00518
V measure:    0.00876                    0.00064                    0.00881
Silhouette:   0.27266                    0.30686                    0.27243
CH Score:     647.79394                 2.97155                    647.73094

Cluster  4
              K-means results      Spectral clustering results       GMM results
ARI:          0.01161                    0.00005                  0.01167
Rand:         0.68618                    0.08351                    0.68381
FM:           0.16406                    0.28603                    0.16493
Completeness: 0.03822                    0.29533                    0.03971
Homogeneity:  0.01985                    0.00097                    0.02056
V measure:    0.02613                    0.00194                    0.02709
Silhouette:   0.08319                    0.25383                    0.08446
CH Score:     334.10803                 2.91436                    332.79050

Cluster  6
              K-means results      Spectral clustering results       GMM results
ARI:          0.02037                    0.00000                  0.02296
Rand:         0.75676                    0.08296                    0.77444
FM:           0.14748                    0.28605                    0.14273
Completeness: 0.05975                    0.27726                    0.06450
Homogeneity:  0.03944                    0.00061                    0.04449
V measure:    0.04752                    0.00122                    0.05266
Silhouette:   0.04485                    0.28123                    0.05395
CH Score:     235.10638                 2.92602                    227.77347

Cluster  8
              K-means results      Spectral clustering results       GMM results
ARI:          0.02184                    0.00005                  0.01840
Rand:         0.80345                    0.08351                    0.79067
FM:           0.12830                    0.28603                    0.13074
Completeness: 0.06272                    0.29533                    0.06151
Homogeneity:  0.04940                    0.00097                    0.04686
V measure:    0.05527                    0.00194                    0.05319
Silhouette:   0.03674                    0.25383                    0.02622
CH Score:     184.84368                 2.91436                    179.84452

Cluster  10
              K-means results      Spectral clustering results       GMM results
ARI:          0.02141                    0.00000                  0.02304
Rand:         0.83005                    0.08296                    0.81583
FM:           0.11442                    0.28605                    0.12345
Completeness: 0.06048                    0.27726                    0.06720
Homogeneity:  0.05341                    0.00061                    0.05676
V measure:    0.05673                    0.00122                    0.06154
Silhouette:   0.02753                    0.28123                    0.02244
CH Score:     154.39417                 2.92602                    149.76372

Cluster  12
              K-means results      Spectral clustering results       GMM results
ARI:          0.02806                    0.00000                  0.02299
Rand:         0.84258                    0.08296                    0.83834
FM:           0.11422                    0.28605                    0.11149
Completeness: 0.07592                    0.27726                    0.07014
Homogeneity:  0.07177                    0.00061                    0.06542
V measure:    0.07379                    0.00122                    0.06770
Silhouette:   0.02628                    0.28123                    0.01936
CH Score:     132.82745                 2.92602                    131.81017

Cluster  14
              K-means results      Spectral clustering results       GMM results
ARI:          0.02580                    0.00005                  0.03131
Rand:         0.85344                    0.08351                    0.84765
FM:           0.10563                    0.28603                    0.11458
Completeness: 0.07557                    0.29533                    0.08418
Homogeneity:  0.07581                    0.00097                    0.08279
V measure:    0.07569                    0.00194                    0.08348
Silhouette:   0.02328                    0.25383                    0.02562
CH Score:     117.74571                 2.91436                    115.11409
Finished cluster for  MVAE
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [86  0  0 50  0 34  0 60  0 26 44  0  0  0]
2 [137   0   0  50   0  46   0  25   0   5  37   0   0   0]
3 [132   0   0  34   0  36   0  27   0  17  54   0   0   0]
4 [ 78   0   1  49   0  16   0 108   0  20  28   0   0   0]
5 [41  0  1 23  0 17  0 52  0 10 16  0  0  0]
6 [113   0   0  94   0  18   0  20   0  19  36   0   0   0]
7 [15  0  0 17  0  8  0  4  0 13 15  0  0  0]
8 [98  0  0 96  0 17  0 19  0 42 28  0  0  0]
9 [21  0  0 16  0  5  0  0  0  6 12  0  0  0]
10 [89  0  0 98  0 13  0 29  0 37 34  0  0  0]
11 [79  0  0 74  0 30  0 41  0 27 49  0  0  0]
12 [65  0  0 37  0 40  0 13  0 12 45  0  0  0]
13 [45  0  0 22  0 11  0  3  0  4 23  0  0  0]
14 [86  0  0 40  0 16  0 33  0  7 46  0  0  0]
F1 Score: 0.055260857995331716
Finished GMM Classification for  MVAE

Start classification fine-tuning
Epoch: 4 	 Train Loss: 20.084249	 Test Loss: 26.029653
Epoch: 9 	 Train Loss: 20.352125	 Test Loss: 21.194233
Epoch: 14 	 Train Loss: 10.332665	 Test Loss: 8.732194
Epoch: 19 	 Train Loss: 3.021144	 Test Loss: 2.855998
Epoch: 24 	 Train Loss: 1.700915	 Test Loss: 1.650159
Epoch: 29 	 Train Loss: 1.108852	 Test Loss: 1.107265
Epoch: 34 	 Train Loss: 0.789028	 Test Loss: 0.760306
Epoch: 39 	 Train Loss: 0.558862	 Test Loss: 0.559336
Epoch: 44 	 Train Loss: 0.369032	 Test Loss: 0.369494
Epoch: 49 	 Train Loss: 0.270950	 Test Loss: 0.282108
Epoch: 54 	 Train Loss: 0.205473	 Test Loss: 0.215225
Epoch: 59 	 Train Loss: 0.158185	 Test Loss: 0.161707
Epoch: 64 	 Train Loss: 0.129456	 Test Loss: 0.136489
Epoch: 69 	 Train Loss: 0.111547	 Test Loss: 0.128671
Epoch: 74 	 Train Loss: 0.101789	 Test Loss: 0.106480
Epoch: 79 	 Train Loss: 0.092982	 Test Loss: 0.100280
Finished training
Best test loss: 0.100280 at epoch: 79
Start evaluation

Evaluation of fine-tuned MVAE model

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [229  70   0   0   0   1   0   0   0   0   0   0   0   0]
2 [199 101   0   0   0   0   0   0   0   0   0   0   0   0]
3 [213  87   0   0   0   0   0   0   0   0   0   0   0   0]
4 [269  31   0   0   0   0   0   0   0   0   0   0   0   0]
5 [133  27   0   0   0   0   0   0   0   0   0   0   0   0]
6 [214  86   0   0   0   0   0   0   0   0   0   0   0   0]
7 [69  3  0  0  0  0  0  0  0  0  0  0  0  0]
8 [170 130   0   0   0   0   0   0   0   0   0   0   0   0]
9 [33 27  0  0  0  0  0  0  0  0  0  0  0  0]
10 [206  94   0   0   0   0   0   0   0   0   0   0   0   0]
11 [211  89   0   0   0   0   0   0   0   0   0   0   0   0]
12 [141  71   0   0   0   0   0   0   0   0   0   0   0   0]
13 [79 28  0  0  0  1  0  0  0  0  0  0  0  0]
14 [159  69   0   0   0   0   0   0   0   0   0   0   0   0]
F1 Score: 0.03157457932945704

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.862571	 Test Loss: 0.847509
Epoch: 9 	 Train Loss: 1.522957	 Test Loss: 0.989549
Epoch: 14 	 Train Loss: 1.959718	 Test Loss: 1.816525
Epoch: 19 	 Train Loss: 1.086891	 Test Loss: 1.111215
Epoch: 24 	 Train Loss: 1.045468	 Test Loss: 1.069394
Epoch: 29 	 Train Loss: 1.037758	 Test Loss: 1.064884
Epoch: 34 	 Train Loss: 1.036051	 Test Loss: 1.063473
Epoch: 39 	 Train Loss: 1.035457	 Test Loss: 1.063201
Epoch: 44 	 Train Loss: 1.035503	 Test Loss: 1.063156
Epoch: 49 	 Train Loss: 1.035295	 Test Loss: 1.063150
Epoch: 54 	 Train Loss: 1.035532	 Test Loss: 1.063150
Epoch: 59 	 Train Loss: 1.035499	 Test Loss: 1.063150
Epoch: 64 	 Train Loss: 1.035845	 Test Loss: 1.063150
Epoch: 69 	 Train Loss: 1.035546	 Test Loss: 1.063150
Epoch: 74 	 Train Loss: 1.035323	 Test Loss: 1.063150
Epoch: 79 	 Train Loss: 1.035420	 Test Loss: 1.063150
Finished training MVAE for risk score prediction
Best test loss: 0.772812 at epoch: 6
Start evaluation

Evaluation of fine-tuned MVAE model

MAPE Score: 60.92336654663086

Finished
