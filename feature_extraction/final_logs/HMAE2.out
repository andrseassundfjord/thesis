Latent dimension: 64, Hidden dimension 1024, Split size 4
Started: HMAE_rerun, Augmented run
Using device: cuda
Model: HMAE
Number of parameters in model:  633536155
torch.cuda.memory_allocated: 2.360120GB
torch.cuda.memory_reserved: 2.365234GB
torch.cuda.max_memory_reserved: 2.365234GB
Start training
Time taken: 2797.36 seconds
Epoch: 9 	 Train Loss: 1128.614692	 Test Loss: 1130.090914
Time taken: 5567.81 seconds
Epoch: 19 	 Train Loss: 904.754434	 Test Loss: 909.846933
Time taken: 8327.29 seconds
Epoch: 29 	 Train Loss: 738.579506	 Test Loss: 744.325612
Time taken: 11082.42 seconds
Epoch: 39 	 Train Loss: 610.907564	 Test Loss: 616.080864
Time taken: 13834.57 seconds
Epoch: 49 	 Train Loss: 511.602727	 Test Loss: 516.160160
Time taken: 16589.49 seconds
Epoch: 59 	 Train Loss: 433.856241	 Test Loss: 437.830811
Time taken: 19339.77 seconds
Epoch: 69 	 Train Loss: 372.738800	 Test Loss: 376.260542
Time taken: 22091.03 seconds
Epoch: 79 	 Train Loss: 324.389678	 Test Loss: 327.805140
Time taken: 24845.24 seconds
Epoch: 89 	 Train Loss: 285.825551	 Test Loss: 288.821023
Time taken: 27602.61 seconds
Epoch: 99 	 Train Loss: 254.865076	 Test Loss: 257.779747
Time taken: 30900.66 seconds
Epoch: 109 	 Train Loss: 229.801820	 Test Loss: 232.590295
Time taken: 34215.15 seconds
Epoch: 119 	 Train Loss: 209.314377	 Test Loss: 212.011754
Time taken: 37512.40 seconds
Epoch: 129 	 Train Loss: 192.283355	 Test Loss: 194.904272
Time taken: 40751.84 seconds
Epoch: 139 	 Train Loss: 177.989105	 Test Loss: 180.568815
Time taken: 44011.32 seconds
Epoch: 149 	 Train Loss: 165.785063	 Test Loss: 168.311554
Finished training
Time taken: 44011.32 seconds
Best test loss: 168.311554 at epoch: 149
Timeseries MAPE: 0.000000
Video MAPE: 0.000000
Masked MAPE: 0.000000
Started Cluster task
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results       GMM results
ARI:          -0.00009                    -0.00011                  -0.00046
Rand:         0.10676                    0.10824                    0.12670
FM:           0.28178                    0.28149                    0.27766
Completeness: 0.14526                    0.12117                    0.05469
Homogeneity:  0.00447                    0.00391                    0.00272
V measure:    0.00867                    0.00758                    0.00519
Silhouette:   0.83341                    0.83138                    0.79729
CH Score:     1969.26739                 1902.06807                    1484.16922

Cluster  4
              K-means results      Spectral clustering results       GMM results
ARI:          0.00444                    0.00444                  -0.00057
Rand:         0.51616                    0.51508                    0.32386
FM:           0.20440                    0.20467                    0.24041
Completeness: 0.04333                    0.04325                    0.05901
Homogeneity:  0.01590                    0.01582                    0.01273
V measure:    0.02327                    0.02317                    0.02094
Silhouette:   0.60056                    0.61576                    0.60130
CH Score:     2904.06644                 2695.59419                    2384.03470

Cluster  6
              K-means results      Spectral clustering results       GMM results
ARI:          0.00450                    0.00448                  -0.00058
Rand:         0.52959                    0.52949                    0.32397
FM:           0.20106                    0.20107                    0.24037
Completeness: 0.06011                    0.06020                    0.07017
Homogeneity:  0.02424                    0.02426                    0.01554
V measure:    0.03455                    0.03459                    0.02545
Silhouette:   0.64705                    0.64766                    0.60476
CH Score:     3647.19920                 3637.53645                    1765.17430

Cluster  8
              K-means results      Spectral clustering results       GMM results
ARI:          0.00451                    0.01730                  -0.00025
Rand:         0.53733                    0.70858                    0.34684
FM:           0.19909                    0.16270                    0.23619
Completeness: 0.06873                    0.07053                    0.09140
Homogeneity:  0.03028                    0.04294                    0.02343
V measure:    0.04204                    0.05338                    0.03730
Silhouette:   0.66153                    0.40476                    0.47417
CH Score:     4154.99300                 2701.20098                    1516.54436

Cluster  10
              K-means results      Spectral clustering results       GMM results
ARI:          0.01623                    0.01271                  -0.00066
Rand:         0.70331                    0.68926                    0.33548
FM:           0.16339                    0.16427                    0.23791
Completeness: 0.07540                    0.07554                    0.08442
Homogeneity:  0.04609                    0.04574                    0.02068
V measure:    0.05721                    0.05698                    0.03322
Silhouette:   0.42460                    0.42648                    0.62054
CH Score:     4285.15259                 2216.85063                    1428.11822

Cluster  12
              K-means results      Spectral clustering results       GMM results
ARI:          0.01636                    0.02744                  -0.00063
Rand:         0.75631                    0.76458                    0.34713
FM:           0.14336                    0.15177                    0.23556
Completeness: 0.07463                    0.11408                    0.08562
Homogeneity:  0.05280                    0.08565                    0.02377
V measure:    0.06185                    0.09784                    0.03721
Silhouette:   0.40087                    0.33019                    0.60119
CH Score:     4052.44650                 2302.11491                    1666.43965

Cluster  14
              K-means results      Spectral clustering results       GMM results
ARI:          0.01659                    0.02732                  -0.00064
Rand:         0.75789                    0.81302                    0.34896
FM:           0.14296                    0.12921                    0.23516
Completeness: 0.08281                    0.10234                    0.08605
Homogeneity:  0.06051                    0.08918                    0.02402
V measure:    0.06992                    0.09531                    0.03756
Silhouette:   0.39446                    0.26287                    0.60175
CH Score:     3959.65832                 2011.78407                    1683.74689
Finished cluster for  HMAE
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [ 17   0  15   0   0 234   0   3   0  12  19   0   0   0]
2 [ 23   0  40   0   0 228   0   1   0   0   8   0   0   0]
3 [  9   0  27   0   0 257   0   3   0   0   4   0   0   0]
4 [  9   0  23   4   0 247   0   8   0   6   3   0   0   0]
5 [  8   0   7   0   0 132   0   1   0   0  12   0   0   0]
6 [ 27   0  45   1   0 190   0  18   0   8  11   0   0   0]
7 [ 0  0  4  0  0 68  0  0  0  0  0  0  0  0]
8 [ 12   0  41   0   0 229   0   1   0   0  17   0   0   0]
9 [ 0  0  4  0  0 45  0  0  0  0 11  0  0  0]
10 [ 21   0  44   0   0 225   0   1   0   0   9   0   0   0]
11 [ 13   0  32   0   0 239   0   0   0   3  13   0   0   0]
12 [  0   0  15   0   0 166   0   5   0   0  26   0   0   0]
13 [19  0  9  0  0 66  0  1  0  0 13  0  0  0]
14 [ 13   0  31   4   0 153   0   2   0   4  21   0   0   0]
F1 Score: 0.035284951926364085
Finished GMM Classification for  HMAE

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.094140	 Test Loss: 0.100364
Epoch: 9 	 Train Loss: 0.079739	 Test Loss: 0.084017
Epoch: 14 	 Train Loss: 0.079364	 Test Loss: 0.084200
Epoch: 19 	 Train Loss: 0.079223	 Test Loss: 0.084148
Epoch: 24 	 Train Loss: 0.079186	 Test Loss: 0.084190
Epoch: 29 	 Train Loss: 0.079178	 Test Loss: 0.084199
Epoch: 34 	 Train Loss: 0.079189	 Test Loss: 0.084198
Epoch: 39 	 Train Loss: 0.079175	 Test Loss: 0.084199
Epoch: 44 	 Train Loss: 0.079185	 Test Loss: 0.084199
Epoch: 49 	 Train Loss: 0.079190	 Test Loss: 0.084199
Epoch: 54 	 Train Loss: 0.079212	 Test Loss: 0.084199
Epoch: 59 	 Train Loss: 0.079194	 Test Loss: 0.084199
Epoch: 64 	 Train Loss: 0.079194	 Test Loss: 0.084199
Epoch: 69 	 Train Loss: 0.079188	 Test Loss: 0.084199
Epoch: 74 	 Train Loss: 0.079183	 Test Loss: 0.084199
Epoch: 79 	 Train Loss: 0.079179	 Test Loss: 0.084199
Finished training
Best test loss: 0.084017 at epoch: 9
Start evaluation

Evaluation of fine-tuned HMAE model

Confusion matrix
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14']
1 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
2 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
3 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
4 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
5 [160   0   0   0   0   0   0   0   0   0   0   0   0   0]
6 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
7 [72  0  0  0  0  0  0  0  0  0  0  0  0  0]
8 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
9 [60  0  0  0  0  0  0  0  0  0  0  0  0  0]
10 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
11 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
12 [212   0   0   0   0   0   0   0   0   0   0   0   0   0]
13 [108   0   0   0   0   0   0   0   0   0   0   0   0   0]
14 [228   0   0   0   0   0   0   0   0   0   0   0   0   0]
F1 Score: 0.015693659761456372

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.907877	 Test Loss: 1.329633
Epoch: 9 	 Train Loss: 1.448163	 Test Loss: 2.212606
Epoch: 14 	 Train Loss: 0.068401	 Test Loss: 0.053024
Epoch: 19 	 Train Loss: 0.023222	 Test Loss: 0.023121
Epoch: 24 	 Train Loss: 0.014898	 Test Loss: 0.015168
Epoch: 29 	 Train Loss: 0.011802	 Test Loss: 0.012299
Epoch: 34 	 Train Loss: 0.010315	 Test Loss: 0.010967
Epoch: 39 	 Train Loss: 0.009542	 Test Loss: 0.010189
Epoch: 44 	 Train Loss: 0.009142	 Test Loss: 0.010248
Epoch: 49 	 Train Loss: 0.008817	 Test Loss: 0.009491
Epoch: 54 	 Train Loss: 0.008592	 Test Loss: 0.009312
Epoch: 59 	 Train Loss: 0.008507	 Test Loss: 0.009206
Epoch: 64 	 Train Loss: 0.008416	 Test Loss: 0.009163
Epoch: 69 	 Train Loss: 0.008453	 Test Loss: 0.009188
Epoch: 74 	 Train Loss: 0.008423	 Test Loss: 0.009133
Epoch: 79 	 Train Loss: 0.008420	 Test Loss: 0.009161
Finished training HMAE for risk score prediction
Best test loss: 0.009129 at epoch: 78
Start evaluation

Evaluation of fine-tuned HMAE model

MAPE Score: 0.9940270185470581

Finished
