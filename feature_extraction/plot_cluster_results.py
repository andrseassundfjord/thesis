import numpy as np
import matplotlib.pyplot as plt 

def plot_plots():
    plt.rcParams.update({'font.size': 24})
    # Plot kmeans
    vae = np.array([0.31957, 0.11979, 0.09777, 0.05498, 0.05394, 0.04703, 0.05013])
    vvae = np.array([0.47327, 0.25186, 0.20626, 0.16971, 0.15812, 0.13764, 0.13503])
    vtvae = np.array([0.68520, 0.76772, 0.77807, 0.76050, 0.75852, 0.74965, 0.67577])
    tvae = np.array([0.48567, 0.36287, 0.29021, 0.29252, 0.30724 , 0.27414, 0.27411 ])
    ttvae = np.array([0.84085, 0.72275, 0.77019, 0.83475, 0.84808, 0.85236, 0.85083])
    msvae = np.array([0.32464, 0.14981, 0.10467, 0.05506, 0.05299, 0.04802, 0.04358])
    mvae = np.array([0.31935, 0.07260, 0.06435, 0.05589, 0.05305, 0.04640, 0.04583])
    mtvae = np.array([0.50577, 0.44778, 0.42589, 0.45225, 0.44283, 0.43631, 0.41880])
    hmae = np.array([0.69231, 0.64007, 0.69767, 0.39621, 0.36972, 0.37631, 0.37323])
    x = np.linspace(2, 14, 7)
    fig, ax = plt.subplots(figsize=(12, 12))
    # SORT
    ax.plot(x, ttvae, label='Signal TVAE', ls = None, color = "blue")
    ax.plot(x, vtvae, label='Video TVAE', ls = None, color = "red")
    ax.plot(x, hmae, label='HVAE', ls = "-.", color = "yellow")
    ax.plot(x, mtvae, label='MTVAE', ls = None, color = "orange")
    ax.plot(x, tvae, label='Signal VAE', ls = "--", color = "blue")
    ax.plot(x, vvae, label='Video VAE', ls = "--", color = "red")
    ax.plot(x, msvae, label='MSVAE', ls = ":", color = "orange")
    ax.plot(x, vae, label='Video AE', ls = ":", color = "red")
    ax.plot(x, mvae, label='MVAE', ls = "--", color = "orange")
    #ax.set_title('Silhouette score for K-Means')
    ax.set_xlabel('Number of clusters')
    ax.set_ylabel('Silhouette score')
    #ax.legend()
    ax.legend(loc='upper center', bbox_to_anchor=(0.5, 1.2),
          ncol=3, fancybox=True, shadow=True)
    # Shrink current axis by 20%
    box = ax.get_position()
    ax.set_position([box.x0, box.y0, box.width, box.height * 0.95])

    # Put a legend to the right of the current axis
    #ax.legend(loc='center left', bbox_to_anchor=(1, 0.5))

    plt.savefig("results/clustering/plots_all/silhouette_kmeans")
    plt.clf()
    # Plot kmeans
    vae = np.array([1064.97878, 547.71327, 374.10512, 294.05040, 244.48556, 211.22674, 185.83533])
    vvae = np.array([3021.70429, 2069.38689, 1584.55908, 1332.13914, 1140.65797, 1013.58611, 909.74077])
    vtvae = np.array([7637.50346, 22287.93788 , 37705.99813, 49416.34725, 57128.72614,  64902.41763, 68525.61634])
    tvae = np.array([1956.65280, 1815.96349, 1602.55361 , 1507.71516, 1471.33118, 1418.92756, 1341.91972])
    ttvae = np.array([5752.76696, 7558.33167, 11401.07205, 14124.51619, 14039.80338, 13294.00064, 13084.59450])
    msvae = np.array([1107.69124, 561.94736, 389.14609, 304.23759, 251.65917, 217.11650, 189.68165])
    mvae = np.array([834.11542, 421.35993, 299.93599, 237.39814, 196.88832, 169.93521, 149.72910])
    mtvae = np.array([4803.62482, 5828.69137, 6584.38556, 7360.61511, 8181.09291, 8566.99684, 9038.84922])
    hmae = np.array([5855.62492, 6515.16199, 8360.28807, 7434.65589, 7481.61715, 7811.22261, 8104.60456])
    x = np.linspace(2, 14, 7)
    fig, ax = plt.subplots(figsize=(12, 12))
    ax.plot(x, ttvae, label='Signal TVAE', ls = None, color = "blue")
    ax.plot(x, vtvae, label='Video TVAE', ls = None, color = "red")
    ax.plot(x, hmae, label='HVAE', ls = None, color = "yellow")
    ax.plot(x, mtvae, label='MTVAE', ls = None, color = "orange")
    ax.plot(x, tvae, label='Signal VAE', ls = "-", color = "blue")
    ax.plot(x, vvae, label='Video VAE', ls = "-", color = "red")
    ax.plot(x, msvae, label='MSVAE', ls = ":", color = "orange")
    ax.plot(x, vae, label='Video AE', ls = ":", color = "red")
    ax.plot(x, mvae, label='MVAE', ls = "-", color = "orange")
    #ax.set_title('Calinski-Harabasz score for K-Means')
    ax.set_xlabel('Number of clusters')
    ax.set_ylabel('Calinski-Harabasz score')
    #ax.legend()
    ax.legend(loc='upper center', bbox_to_anchor=(0.5, 1.2),
        ncol=3, fancybox=True, shadow=True)
    box = ax.get_position()
    ax.set_position([box.x0, box.y0, box.width, box.height * 0.95])
    plt.yscale('log')
    plt.savefig("results/clustering/plots_all/ch_kmeans")
    plt.clf()
    # Plot spectral
    vae = np.array([0.34505, 0.25491, 0.22563, 0.14837, 0.14139, 0.12594, 0.10124])
    vvae = np.array([0.48826, 0.22424, 0.21119, 0.16099, 0.14614, 0.13479, 0.12160])
    vtvae = np.array([0.41250, 0.22503, 0.54602, 0.64800, 0.61699, 0.61465, 0.61015])
    tvae = np.array([0.77695, 0.63736, 0.63736, 0.39837, 0.59946,  0.62598, 0.39837])
    ttvae = np.array([0.85051, 0.82105, 0.74687, 0.75887, 0.80964, 0.73729, 0.73827])
    msvae = np.array([0.34456, 0.34456, 0.34456, 0.34456, 0.34456, 0.34456, 0.34456])
    mvae = np.array([0.32176, 0.23698, 0.22777,  0.19260,  0.17822, 0.17474, 0.15216])
    mtvae = np.array([0.50671, 0.26880, 0.42045, 0.33155, 0.29820, 0.22452, 0.19874])
    hmae = np.array([0.69037, 0.66692, 0.69590, 0.48797, 0.38418, 0.26531, 0.21417])
    x = np.linspace(2, 14, 7)
    fig, ax = plt.subplots(figsize=(12, 12))
    ax.plot(x, ttvae, label='Signal TVAE', ls = None, color = "blue")
    ax.plot(x, vtvae, label='Video TVAE', ls = None, color = "red")
    ax.plot(x, hmae, label='HVAE', ls = None, color = "yellow")
    ax.plot(x, mtvae, label='MTVAE', ls = None, color = "orange")
    ax.plot(x, tvae, label='Signal VAE', ls = "-", color = "blue")
    ax.plot(x, vvae, label='Video VAE', ls = "-", color = "red")
    ax.plot(x, msvae, label='MSVAE', ls = ":", color = "orange")
    ax.plot(x, vae, label='Video AE', ls = ":", color = "red")
    ax.plot(x, mvae, label='MVAE', ls = "-", color = "orange")
    #ax.set_title('Silhouette score for spectral clustering')
    ax.set_xlabel('Number of clusters')
    ax.set_ylabel('Silhouette score')
    #ax.legend()
    ax.legend(loc='upper center', bbox_to_anchor=(0.5, 1.2),
        ncol=3, fancybox=True, shadow=True)
    box = ax.get_position()
    ax.set_position([box.x0, box.y0, box.width, box.height * 0.95])
    plt.savefig("results/clustering/plots_all/silhouette_spectral")
    plt.clf()
    # Plot spectral
    vae = np.array([3.44849, 4.08509, 3.19896, 2.83116, 2.91926, 2.77772, 2.53387])
    vvae = np.array([2828.09353, 1665.44450, 1393.52596, 1025.11366, 874.71755, 736.43672, 639.13005])
    vtvae = np.array([8.94401, 764.39540, 3765.38951 , 7655.57061, 7411.76285, 6072.23687, 5336.03365])
    tvae = np.array([28.03557, 25.49834, 25.49834, 22.52118, 20.52437, 19.23102, 22.52118])
    ttvae = np.array([2319.81804, 2408.65219, 6138.46865, 7337.62764, 8353.33000, 6363.47764, 6168.38950])
    msvae = np.array([3.41382, 3.41382, 3.41382, 3.41382, 3.41382, 3.41382, 3.41382])
    mvae = np.array([5.74974, 3.64975, 3.63075, 3.30597, 3.57997, 3.10548, 3.33538])
    mtvae = np.array([4795.90593, 1937.45159, 3840.89415, 3440.93730, 3483.13538, 3015.71635,  3048.80647 ])
    hmae = np.array([5851.90858, 5737.80708, 8198.69140, 4891.42010, 6837.59841, 4391.56981, 4618.43095])
    x = np.linspace(2, 14, 7)
    fig, ax = plt.subplots(figsize=(12, 12))
    ax.plot(x, ttvae, label='Signal TVAE', ls = None, color = "blue")
    ax.plot(x, vtvae, label='Video TVAE', ls = None, color = "red")
    ax.plot(x, hmae, label='HVAE', ls = None, color = "yellow")
    ax.plot(x, mtvae, label='MTVAE', ls = None, color = "orange")
    ax.plot(x, tvae, label='Signal VAE', ls = "-", color = "blue")
    ax.plot(x, vvae, label='Video VAE', ls = "-", color = "red")
    ax.plot(x, msvae, label='MSVAE', ls = ":", color = "orange")
    ax.plot(x, vae, label='Video AE', ls = ":", color = "red")
    ax.plot(x, mvae, label='MVAE', ls = "-", color = "orange")
    #ax.set_title('Calinski-Harabasz score for spectral clustering')
    ax.set_xlabel('Number of clusters')
    ax.set_ylabel('Calinski-Harabasz score')
    #ax.legend()
    ax.legend(loc='upper center', bbox_to_anchor=(0.5, 1.2),
        ncol=3, fancybox=True, shadow=True)
    box = ax.get_position()
    ax.set_position([box.x0, box.y0, box.width, box.height * 0.95])
    plt.yscale('log')
    plt.savefig("results/clustering/plots_all/ch_spectral")
    plt.clf()
    # Plot gmm
    vae = np.array([0.31633, 0.07406, 0.08255, 0.08441, 0.04582, 0.03974, 0.04228])
    vvae = np.array([0.47443, 0.20713, 0.17512, 0.15857, 0.12204, 0.13554, 0.12810])
    vtvae = np.array([0.68471, 0.76693, 0.73792, 0.76048, 0.70814, 0.74855, 0.71648])
    tvae = np.array([0.16768, 0.08846, 0.00939, -0.02606, 0.02252, 0.02243, 0.00426])
    ttvae = np.array([0.84480, 0.69583, 0.71975, 0.79355, 0.79794, 0.79184, 0.79257])
    msvae = np.array([0.32221, 0.06116, 0.07984, 0.05489, 0.05021, 0.04790, 0.04836])
    mvae = np.array([0.27095, 0.04475, 0.04985, 0.04177, 0.03355, 0.03826,  0.04455])
    mtvae = np.array([0.45130, 0.34817, 0.30679, 0.20484, 0.16324, 0.12831, 0.08957])
    hmae = np.array([0.67321, 0.65483, 0.69759, 0.65803, 0.50935, 0.54865, 0.64475])
    x = np.linspace(2, 14, 7)
    fig, ax = plt.subplots(figsize=(12, 12))
    ax.plot(x, ttvae, label='Signal TVAE', ls = None, color = "blue")
    ax.plot(x, vtvae, label='Video TVAE', ls = None, color = "red")
    ax.plot(x, hmae, label='HVAE', ls = None, color = "yellow")
    ax.plot(x, mtvae, label='MTVAE', ls = None, color = "orange")
    ax.plot(x, tvae, label='Signal VAE', ls = "-", color = "blue")
    ax.plot(x, vvae, label='Video VAE', ls = "-", color = "red")
    ax.plot(x, msvae, label='MSVAE', ls = ":", color = "orange")
    ax.plot(x, vae, label='Video AE', ls = ":", color = "red")
    ax.plot(x, mvae, label='MVAE', ls = "-", color = "orange")
    #ax.set_title('Silhouette score for GMM clustering')
    ax.set_xlabel('Number of clusters')
    ax.set_ylabel('Silhouette score')
    #ax.legend()
    ax.legend(loc='upper center', bbox_to_anchor=(0.5, 1.2),
        ncol=3, fancybox=True, shadow=True)
    box = ax.get_position()
    ax.set_position([box.x0, box.y0, box.width, box.height * 0.95])
    plt.savefig("results/clustering/plots_all/silhouette_gmm")
    plt.clf()
    # Plot spectral
    vae = np.array([1052.79613, 466.15467, 342.69111, 276.46024, 233.83509, 201.59262, 179.01209])
    vvae = np.array([2939.11882, 1799.48311, 1409.69111, 1181.04781, 1060.66395, 969.56502, 885.25059])
    vtvae = np.array([7636.40965, 22278.30818, 29582.11007, 49401.68593, 46578.87149, 64762.16166, 66212.62274])
    tvae = np.array([526.79778, 562.37755, 583.30915, 481.79086, 603.29003, 618.98387, 655.21384])
    ttvae = np.array([5745.08350, 6028.70688, 5920.21617, 9889.32319,  8594.34559, 10035.97815, 10462.34726])
    msvae = np.array([1104.43822, 453.97301, 348.87520, 299.81516, 249.48208, 210.59979, 189.45183])
    mvae = np.array([ 680.42695, 369.59326, 270.27752, 219.01608, 183.04475, 162.43808, 142.93539])
    mtvae = np.array([4072.49185, 4040.98139, 3887.78668, 3681.50432, 3324.07393, 3215.60141, 2634.90059])
    hmae = np.array([5631.66285, 5905.18306, 8343.85336, 7348.93950, 5826.89118, 6545.00487, 6335.88953])
    x = np.linspace(2, 14, 7)
    fig, ax = plt.subplots(figsize=(12, 12))
    ax.plot(x, ttvae, label='Signal TVAE', ls = None, color = "blue")
    ax.plot(x, vtvae, label='Video TVAE', ls = None, color = "red")
    ax.plot(x, hmae, label='HVAE', ls = None, color = "yellow")
    ax.plot(x, mtvae, label='MTVAE', ls = None, color = "orange")
    ax.plot(x, tvae, label='Signal VAE', ls = "-", color = "blue")
    ax.plot(x, vvae, label='Video VAE', ls = "-", color = "red")
    ax.plot(x, msvae, label='MSVAE', ls = ":", color = "orange")
    ax.plot(x, vae, label='Video AE', ls = ":", color = "red")
    ax.plot(x, mvae, label='MVAE', ls = "-", color = "orange")
    #ax.set_title('Calinski-Harabasz score for GMM clustering')
    ax.set_xlabel('Number of clusters')
    ax.set_ylabel('Calinski-Harabasz score')
    #ax.legend()
    ax.legend(loc='upper center', bbox_to_anchor=(0.5, 1.2),
        ncol=3, fancybox=True, shadow=True)
    box = ax.get_position()
    ax.set_position([box.x0, box.y0, box.width, box.height * 0.95])
    plt.yscale('log')
    plt.savefig("results/clustering/plots_all/ch_gmm")

def plot_confusion():
    arr = np.array([[65, 28, 99, 26, 0, 0, 0, 0, 0, 63, 19, 0, 0, 0],
        [72, 12, 107, 34, 0, 1, 0, 1, 0, 38, 35, 0, 0, 0],
        [59, 14, 34, 60, 0, 0, 0, 0, 0, 101, 32, 0, 0, 0],
        [139, 36, 35, 35, 0, 0, 0, 2, 0, 53, 0, 0, 0, 0],
        [91, 29, 13, 9, 0, 0, 0, 0, 0, 18, 0, 0, 0, 0],
        [107, 57, 22, 40, 0, 0, 0, 0, 0, 73, 1, 0, 0, 0],
        [43, 4, 0, 4, 0, 0, 0, 0, 0, 21, 0, 0, 0, 0],
        [45, 9, 8, 76, 0, 0, 0, 0, 0, 97, 65, 0, 0, 0],
        [6, 6, 0, 21, 0, 0, 0, 0, 0, 12, 15, 0, 0, 0],
        [69, 33, 125, 24, 0, 0, 0, 0, 0, 45, 4, 0, 0, 0],
        [57, 32, 100, 28, 0, 0, 0, 0, 0, 74, 9, 0, 0, 0],
        [63, 19, 37, 33, 0, 0, 0, 0, 0, 53, 7, 0, 0, 0],
        [11, 0, 23, 36, 0, 0, 0, 0, 0, 22, 16, 0, 0, 0],
        [23, 4, 69, 50, 0, 0, 0, 0, 0, 47, 35, 0, 0, 0]
    ])

if __name__ == "__main__":
    plot_plots()