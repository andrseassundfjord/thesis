Latent dimension: 32, Hidden dimension 512, Split size 4
Started: VideoBERT_256x256, Augmented run
Using device: cuda
Model: VideoBERT
Number of parameters in model:  46207491
torch.cuda.memory_allocated: 0.173115GB
torch.cuda.memory_reserved: 0.173828GB
torch.cuda.max_memory_reserved: 0.173828GB
Start training
Time taken: 2911.39 seconds
Epoch: 9 	 Train Loss: 684673.548215	 Test Loss: 656131.329012
Time taken: 5663.21 seconds
Epoch: 19 	 Train Loss: 463719.204315	 Test Loss: 465603.971605
Time taken: 8317.07 seconds
Epoch: 29 	 Train Loss: 419818.692062	 Test Loss: 433999.337037
Time taken: 10944.24 seconds
Epoch: 39 	 Train Loss: 402605.382792	 Test Loss: 418226.596296
Time taken: 13569.75 seconds
Epoch: 49 	 Train Loss: 387312.039691	 Test Loss: 402556.140123
Time taken: 16117.03 seconds
Epoch: 59 	 Train Loss: 376703.387853	 Test Loss: 392278.350617
Time taken: 18635.30 seconds
Epoch: 69 	 Train Loss: 369060.190996	 Test Loss: 384444.856481
Time taken: 21158.41 seconds
Epoch: 79 	 Train Loss: 361309.173948	 Test Loss: 379229.020988
Time taken: 23671.79 seconds
Epoch: 89 	 Train Loss: 355113.127331	 Test Loss: 371235.665432
Time taken: 26205.98 seconds
Epoch: 99 	 Train Loss: 350326.670751	 Test Loss: 367474.197840
Time taken: 28726.51 seconds
Epoch: 109 	 Train Loss: 345854.906766	 Test Loss: 364248.696914
Time taken: 31229.30 seconds
Epoch: 119 	 Train Loss: 341872.512254	 Test Loss: 361423.740741
Time taken: 33727.41 seconds
Epoch: 129 	 Train Loss: 338389.123069	 Test Loss: 359212.743827
Time taken: 36219.78 seconds
Epoch: 139 	 Train Loss: 335325.956846	 Test Loss: 360160.933025
Time taken: 38716.66 seconds
Epoch: 149 	 Train Loss: 332541.571391	 Test Loss: 355668.722531

Finished training
Time taken: 38716.66 seconds
Best test loss: 355012.854630 at epoch: 141
Video loss: 354946.63688271603, at epoch: 141
Timeseries MAPE: 0.000000
Video MAPE: 2.442781
Masked MAPE: 0.000000
Started Cluster task
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results       GMM results
ARI:          0.00020                    0.00000                  0.00022
Rand:         0.34154                    0.00000                    0.34092
FM:           0.23797                    0.00000                    0.23813
Completeness: 0.02235                    0.00000                    0.02232
Homogeneity:  0.00429                    0.00000                    0.00428
V measure:    0.00720                    0.00000                    0.00718
Silhouette:   0.61137                    0.00000                    0.61142
CH Score:     5876.72651                 0.00000                    5864.65975

Cluster  4
              K-means results      Spectral clustering results       GMM results
ARI:          0.00732                    -0.00008                  0.01164
Rand:         0.69598                    0.09008                    0.70639
FM:           0.15582                    0.28468                    0.15709
Completeness: 0.02751                    0.25626                    0.03685
Homogeneity:  0.01457                    0.00367                    0.01982
V measure:    0.01905                    0.00723                    0.02578
Silhouette:   0.20922                    -0.04216                    0.17673
CH Score:     3020.36823                 5.05389                    2624.94998

Cluster  6
              K-means results      Spectral clustering results       GMM results
ARI:          0.01069                    0.00017                  0.01425
Rand:         0.76738                    0.09951                    0.76761
FM:           0.13277                    0.28350                    0.13645
Completeness: 0.03794                    0.23959                    0.04421
Homogeneity:  0.02587                    0.00686                    0.03008
V measure:    0.03076                    0.01334                    0.03580
Silhouette:   0.14450                    -0.05962                    0.08304
CH Score:     2128.17715                 5.14050                    1775.00619

Cluster  8
              K-means results      Spectral clustering results       GMM results
ARI:          0.01427                    0.00015                  0.01555
Rand:         0.81368                    0.10052                    0.81240
FM:           0.11560                    0.28328                    0.11753
Completeness: 0.04286                    0.28168                    0.04630
Homogeneity:  0.03475                    0.00910                    0.03742
V measure:    0.03838                    0.01762                    0.04139
Silhouette:   0.12988                    -0.12588                    0.14719
CH Score:     1694.41995                 4.38455                    1373.63090

Cluster  10
              K-means results      Spectral clustering results       GMM results
ARI:          0.01410                    0.00031                  0.01725
Rand:         0.83430                    0.10627                    0.83573
FM:           0.10477                    0.28257                    0.10716
Completeness: 0.04386                    0.25694                    0.05138
Homogeneity:  0.03935                    0.01066                    0.04620
V measure:    0.04148                    0.02047                    0.04865
Silhouette:   0.13245                    -0.11620                    0.08596
CH Score:     1413.18336                 3.78707                    1250.66008

Cluster  12
              K-means results      Spectral clustering results       GMM results
ARI:          0.01618                    0.00016                  0.01632
Rand:         0.84565                    0.10715                    0.84641
FM:           0.10052                    0.28215                    0.10021
Completeness: 0.05084                    0.28382                    0.04902
Homogeneity:  0.04868                    0.01263                    0.04706
V measure:    0.04974                    0.02418                    0.04802
Silhouette:   0.12274                    -0.20881                    0.07661
CH Score:     1223.55267                 3.49942                    1077.42777

Cluster  14
              K-means results      Spectral clustering results       GMM results
ARI:          0.01553                    0.00013                  0.02156
Rand:         0.85477                    0.10814                    0.85661
FM:           0.09446                    0.28193                    0.09942
Completeness: 0.05684                    0.28848                    0.06350
Homogeneity:  0.05769                    0.01351                    0.06468
V measure:    0.05726                    0.02581                    0.06409
Silhouette:   0.11440                    -0.22739                    0.07409
CH Score:     1087.35902                 3.02845                    958.48912
FOR PLOT
[0.6113655, 0.20922284, 0.14449905, 0.12988004, 0.13244978, 0.12274366, 0.11440084]
[5876.726507990975, 3020.368234961949, 2128.177146180348, 1694.4199494031188, 1413.183359939678, 1223.5526673830998, 1087.359016784302]
[0, -0.042156097, -0.059618235, -0.12588157, -0.116199896, -0.20881306, -0.22739209]
[0, 5.053890191088017, 5.140500277110134, 4.384550396535984, 3.787065241903297, 3.4994152596566157, 3.0284460696112045]
[0.61141616, 0.17672835, 0.08304169, 0.14718632, 0.0859647, 0.07661291, 0.074090645]
[5864.659745436322, 2624.9499847590355, 1775.0061884483052, 1373.6309026169815, 1250.660079515088, 1077.4277659600864, 958.4891187256519]
 
Finished cluster for  VideoBERT
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
1 [39 29 63 31  2 26  0 49  0  0 61  0  0  0]
2 [63 45 39 29  0 19  0 67  0  3 35  0  0  0]
3 [69 23 46 23  0 52  0 52  0  0 35  0  0  0]
4 [35 27 61 61  0 26  0 61  0  6 23  0  0  0]
5 [22 20 52 14  0 20  0 24  0  0  8  0  0  0]
6 [20 32 56 11  0 18  0 94  0  8 61  0  0  0]
7 [ 0  0 16 13  0  4  0 18  0  0 21  0  0  0]
8 [42 38 37 13  3  9  0 69  0  7 82  0  0  0]
9 [16  5  1  3  0  5  0 13  0  0 17  0  0  0]
10 [39 50 33  7  2 15  0 71  0  5 78  0  0  0]
11 [31 38 70 12  1 18  0 60  0  2 68  0  0  0]
12 [42 31 36 24  0 22  0 27  0  0 30  0  0  0]
13 [26 24  2 12  1 14  0  6  0  0 23  0  0  0]
14 [38 41 42  3  0 15  0 32  0  2 55  0  0  0]
F1 Score: 0.0876713849366246
Finished GMM Classification for  VideoBERT
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['1', '5', '9']
1 [129 113  58]
2 [148  76  76]
3 [ 98 114  88]
F1 Score: 0.3238199805569852
Finished GMM Classification for  VideoBERT
lr: 0.1, hidden_dim: 1024

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.096419	 Test Loss: 0.109837
Epoch: 9 	 Train Loss: 0.093086	 Test Loss: 0.085545
Epoch: 14 	 Train Loss: 0.082992	 Test Loss: 0.084708
Epoch: 19 	 Train Loss: 0.082957	 Test Loss: 0.084711
Epoch: 24 	 Train Loss: 0.082955	 Test Loss: 0.084684
Epoch: 29 	 Train Loss: 0.082953	 Test Loss: 0.084710
Epoch: 34 	 Train Loss: 0.082956	 Test Loss: 0.084690
Epoch: 39 	 Train Loss: 0.082960	 Test Loss: 0.084712
Finished training
Best test loss: 0.084684 at epoch: 24
Start evaluation, classes for  range(0, 14)

Evaluation of fine-tuned VideoBERT model

Confusion matrix
['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
1 [299   0   0   0   0   0   0   0   0   1   0   0   0   0]
2 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
3 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
4 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
5 [160   0   0   0   0   0   0   0   0   0   0   0   0   0]
6 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
7 [72  0  0  0  0  0  0  0  0  0  0  0  0  0]
8 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
9 [60  0  0  0  0  0  0  0  0  0  0  0  0  0]
10 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
11 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
12 [212   0   0   0   0   0   0   0   0   0   0   0   0   0]
13 [108   0   0   0   0   0   0   0   0   0   0   0   0   0]
14 [228   0   0   0   0   0   0   0   0   0   0   0   0   0]
F1 Score: 0.015645767270520024
lr: 0.1, hidden_dim: 1024

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.034620	 Test Loss: 0.012237
Epoch: 9 	 Train Loss: 0.034493	 Test Loss: 0.012365
Epoch: 14 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 19 	 Train Loss: 0.034548	 Test Loss: 0.012207
Finished training
Best test loss: 0.012207 at epoch: 7
Start evaluation, classes for  [1, 5, 9]

Evaluation of fine-tuned VideoBERT model

Confusion matrix
['1', '5', '9']
1 [300   0   0]
2 [300   0   0]
3 [300   0   0]
F1 Score: 0.16666666666666666

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.029647	 Test Loss: 0.011303
Epoch: 9 	 Train Loss: 0.027545	 Test Loss: 0.014816
Epoch: 14 	 Train Loss: 0.009697	 Test Loss: 0.008032
Epoch: 19 	 Train Loss: 0.009135	 Test Loss: 0.007703
Epoch: 24 	 Train Loss: 0.009129	 Test Loss: 0.007636
Epoch: 29 	 Train Loss: 0.009152	 Test Loss: 0.007721
Epoch: 34 	 Train Loss: 0.009095	 Test Loss: 0.007660
Epoch: 39 	 Train Loss: 0.009066	 Test Loss: 0.007631
Finished training VideoBERT for risk score prediction
Best test loss: 0.007569 at epoch: 23
Start evaluation


Evaluation of fine-tuned VideoBERT model

MAPE Score: 1.1893738508224487

Finished
