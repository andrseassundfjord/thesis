Latent dimension: 64, Hidden dimension 512, Split size 4
Started: VideoVAE_reduced_parameters, Augmented run
Using device: cuda
Model: VideoVAE
Number of parameters in model:  103401731
torch.cuda.memory_allocated: 0.388671GB
torch.cuda.memory_reserved: 0.410156GB
torch.cuda.max_memory_reserved: 0.410156GB
Start training
Time taken: 968.59 seconds
Epoch: 9 	 Train Loss: 234045.651572	 Test Loss: 228920.060185
Time taken: 1869.40 seconds
Epoch: 19 	 Train Loss: 206969.096430	 Test Loss: 201206.561574
Time taken: 2821.19 seconds
Epoch: 29 	 Train Loss: 171218.466303	 Test Loss: 170504.390741
Time taken: 3736.95 seconds
Epoch: 39 	 Train Loss: 155312.081646	 Test Loss: 152766.959722
Time taken: 4655.16 seconds
Epoch: 49 	 Train Loss: 147132.518780	 Test Loss: 145379.684105
Time taken: 5563.79 seconds
Epoch: 59 	 Train Loss: 143544.643580	 Test Loss: 141775.598611
Time taken: 6470.13 seconds
Epoch: 69 	 Train Loss: 140569.707379	 Test Loss: 138968.567747
Time taken: 7380.56 seconds
Epoch: 79 	 Train Loss: 138148.609350	 Test Loss: 136024.806636
Time taken: 8285.93 seconds
Epoch: 89 	 Train Loss: 135595.441795	 Test Loss: 133830.121914
Time taken: 9185.28 seconds
Epoch: 99 	 Train Loss: 133406.950586	 Test Loss: 131548.865123
Time taken: 10086.13 seconds
Epoch: 109 	 Train Loss: 131673.673149	 Test Loss: 130504.482407
Time taken: 11532.96 seconds
Epoch: 119 	 Train Loss: 130570.944992	 Test Loss: 130629.192130
Time taken: 13525.71 seconds
Epoch: 129 	 Train Loss: 129608.735216	 Test Loss: 128422.975926
Time taken: 15869.73 seconds
Epoch: 139 	 Train Loss: 128162.168887	 Test Loss: 127609.581790
Time taken: 18301.66 seconds
Epoch: 149 	 Train Loss: 127733.383724	 Test Loss: 127701.570216
Finished training
Time taken: 18301.66 seconds
Best test loss: 126845.674383 at epoch: 144
Video loss: 125928.12881944445, at epoch: 144
Timeseries MAPE: 0.000000
Video MAPE: 3.292845
Masked MAPE: 0.000000
Started Cluster task
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results       GMM results
ARI:          0.00051                    0.00000                  0.00052
Rand:         0.32612                    0.00000                    0.32977
FM:           0.24161                    0.00000                    0.24088
Completeness: 0.02830                    0.00000                    0.02959
Homogeneity:  0.00519                    0.00000                    0.00548
V measure:    0.00877                    0.00000                    0.00925
Silhouette:   0.49449                    0.00000                    0.48891
CH Score:     2917.56727                 0.00000                    2883.91532

Cluster  4
              K-means results      Spectral clustering results       GMM results
ARI:          0.00799                    0.00289                  0.00787
Rand:         0.69954                    0.60233                    0.69151
FM:           0.15536                    0.17948                    0.15796
Completeness: 0.02886                    0.03138                    0.03011
Homogeneity:  0.01535                    0.01333                    0.01583
V measure:    0.02004                    0.01872                    0.02075
Silhouette:   0.22457                    0.21219                    0.19534
CH Score:     1933.62829                 1633.05328                    1699.24366

Cluster  6
              K-means results      Spectral clustering results       GMM results
ARI:          0.01147                    0.00132                  0.01061
Rand:         0.74975                    0.54178                    0.74683
FM:           0.14073                    0.19375                    0.14095
Completeness: 0.03979                    0.04437                    0.03942
Homogeneity:  0.02601                    0.01831                    0.02564
V measure:    0.03145                    0.02593                    0.03107
Silhouette:   0.20020                    0.18239                    0.16406
CH Score:     1535.22748                 971.67036                    1367.12383

Cluster  8
              K-means results      Spectral clustering results       GMM results
ARI:          0.01331                    0.00014                  0.01075
Rand:         0.80187                    0.50072                    0.79277
FM:           0.12030                    0.20240                    0.12186
Completeness: 0.04179                    0.04805                    0.03943
Homogeneity:  0.03284                    0.02085                    0.03035
V measure:    0.03678                    0.02908                    0.03430
Silhouette:   0.16587                    0.16764                    0.14002
CH Score:     1284.63822                 735.55199                    1173.25860

Cluster  10
              K-means results      Spectral clustering results       GMM results
ARI:          0.01156                    0.00133                  0.01191
Rand:         0.82538                    0.64330                    0.82446
FM:           0.10694                    0.16567                    0.10777
Completeness: 0.04261                    0.04266                    0.04298
Homogeneity:  0.03721                    0.02516                    0.03744
V measure:    0.03973                    0.03165                    0.04002
Silhouette:   0.15242                    0.12790                    0.13423
CH Score:     1103.72798                 739.40458                    1045.80238

Cluster  12
              K-means results      Spectral clustering results       GMM results
ARI:          0.01111                    0.00690                  0.01157
Rand:         0.83648                    0.68434                    0.83965
FM:           0.10057                    0.15925                    0.09928
Completeness: 0.04357                    0.05541                    0.04425
Homogeneity:  0.04072                    0.03606                    0.04177
V measure:    0.04210                    0.04369                    0.04297
Silhouette:   0.12990                    0.11962                    0.12366
CH Score:     964.86454                 656.55669                    929.55943

Cluster  14
              K-means results      Spectral clustering results       GMM results
ARI:          0.01297                    0.00593                  0.01196
Rand:         0.85287                    0.73122                    0.85171
FM:           0.09303                    0.14178                    0.09270
Completeness: 0.04774                    0.05599                    0.04568
Homogeneity:  0.04824                    0.04103                    0.04599
V measure:    0.04799                    0.04736                    0.04583
Silhouette:   0.12763                    0.11122                    0.11943
CH Score:     873.63426                 621.69196                    849.97053
FOR PLOT
[0.4944883, 0.22456501, 0.20019546, 0.16586983, 0.15242028, 0.12990278, 0.12762867]
[2917.5672707908, 1933.6282949647855, 1535.2274810172437, 1284.6382201629276, 1103.7279765635433, 964.8645418067048, 873.6342600395611]
[0, 0.2121898, 0.1823946, 0.1676409, 0.12789631, 0.11962434, 0.11121665]
[0, 1633.0532769588526, 971.6703613815458, 735.551994389006, 739.4045772562984, 656.5566876724093, 621.6919639848287]
[0.48891157, 0.19533925, 0.16405737, 0.14001983, 0.13423139, 0.123660356, 0.11943463]
[2883.9153228528676, 1699.2436607814038, 1367.1238331694253, 1173.2585992882337, 1045.8023779060852, 929.5594338902146, 849.9705265673424]
 
Finished cluster for  VideoVAE
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
1 [52  1 52 49  0  2  0 41  0 16 72  0  0 15]
2 [32 16 59 28  0  1  0 33  0 30 94  0  0  7]
3 [ 24  12  47  27   0   0   0  38   0  24 122   0   0   6]
4 [37  8 65 66  0  0  0 46  0 16 60  0  0  2]
5 [22  6 37 22  0  0  0 21  0  7 41  0  0  4]
6 [35 15 68 33  0  0  0 18  0 34 79  0  0 18]
7 [ 1  2 17  9  0  0  0 25  0  2 16  0  0  0]
8 [ 32  19  49   9   0   0   0  24   0  30 123   0   0  14]
9 [ 3  0  6  8  0  0  0  4  0  9 30  0  0  0]
10 [38 13 64 32  0  2  0 37  0 25 80  0  0  9]
11 [ 48   8  42  26   0   0   0  22   0  29 116   0   0   9]
12 [17  6 23 25  0  2  0 35  0 15 83  0  0  6]
13 [19 10 16  8  0  0  0  8  0 12 31  0  0  4]
14 [21 24 30  9  0  0  0 23  0 23 75  0  0 23]
F1 Score: 0.08990612273059781
Finished GMM Classification for  VideoVAE
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['1', '5', '9']
1 [189 102   9]
2 [188 106   6]
3 [178 116   6]
F1 Score: 0.273077343490526
Finished GMM Classification for  VideoVAE
lr: 0.1, hidden_dim: 1024

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 9 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 14 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 19 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 24 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 29 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 34 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 39 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 44 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 49 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 54 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 59 	 Train Loss: 0.082954	 Test Loss: 0.084710
Finished training
Best test loss: 0.084710 at epoch: 0
Start evaluation, classes for  range(0, 14)

Evaluation of fine-tuned VideoVAE model

Confusion matrix
['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
1 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
2 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
3 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
4 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
5 [160   0   0   0   0   0   0   0   0   0   0   0   0   0]
6 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
7 [72  0  0  0  0  0  0  0  0  0  0  0  0  0]
8 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
9 [60  0  0  0  0  0  0  0  0  0  0  0  0  0]
10 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
11 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
12 [212   0   0   0   0   0   0   0   0   0   0   0   0   0]
13 [108   0   0   0   0   0   0   0   0   0   0   0   0   0]
14 [228   0   0   0   0   0   0   0   0   0   0   0   0   0]
F1 Score: 0.015693659761456372
lr: 0.1, hidden_dim: 1024

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 9 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 14 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 19 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 24 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 29 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 34 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 39 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 44 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 49 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 54 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 59 	 Train Loss: 0.034533	 Test Loss: 0.012207
Finished training
Best test loss: 0.012207 at epoch: 0
Start evaluation, classes for  [1, 5, 9]

Evaluation of fine-tuned VideoVAE model

Confusion matrix
['1', '5', '9']
1 [300   0   0]
2 [300   0   0]
3 [300   0   0]
F1 Score: 0.16666666666666666

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.009803	 Test Loss: 0.012291
Epoch: 9 	 Train Loss: 0.008829	 Test Loss: 0.009031
Epoch: 14 	 Train Loss: 0.008537	 Test Loss: 0.009315
Epoch: 19 	 Train Loss: 0.008778	 Test Loss: 0.009047
Epoch: 24 	 Train Loss: 0.008759	 Test Loss: 0.009349
Epoch: 29 	 Train Loss: 0.008487	 Test Loss: 0.009006
Epoch: 34 	 Train Loss: 0.008474	 Test Loss: 0.008971
Epoch: 39 	 Train Loss: 0.008460	 Test Loss: 0.009001
Epoch: 44 	 Train Loss: 0.008487	 Test Loss: 0.008986
Epoch: 49 	 Train Loss: 0.008484	 Test Loss: 0.008998
Epoch: 54 	 Train Loss: 0.008455	 Test Loss: 0.008990
Epoch: 59 	 Train Loss: 0.008477	 Test Loss: 0.008989
Finished training VideoVAE for risk score prediction
Best test loss: 0.008894 at epoch: 18
Start evaluation

Evaluation of fine-tuned VideoVAE model

MAPE Score: 1.1194697618484497

Finished
