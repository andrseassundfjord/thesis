Latent dimension: 64, Hidden dimension 512, Split size 4
Started: VideoAE_reduced_parameters, Augmented run
Using device: cuda
Model: VideoAutoencoder
Number of parameters in model:  89352899
torch.cuda.memory_allocated: 0.332871GB
torch.cuda.memory_reserved: 0.333984GB
torch.cuda.max_memory_reserved: 0.333984GB
Start training
Time taken: 677.95 seconds
Epoch: 9 	 Train Loss: 160913.354955	 Test Loss: 149211.179012
Time taken: 1244.92 seconds
Epoch: 19 	 Train Loss: 110625.444459	 Test Loss: 106118.707176
Time taken: 1784.98 seconds
Epoch: 29 	 Train Loss: 101060.917954	 Test Loss: 97736.340046
Time taken: 2314.86 seconds
Epoch: 39 	 Train Loss: 96405.321124	 Test Loss: 93137.828627
Time taken: 2856.34 seconds
Epoch: 49 	 Train Loss: 93473.265850	 Test Loss: 91741.330093
Time taken: 3394.01 seconds
Epoch: 59 	 Train Loss: 91440.506327	 Test Loss: 89192.958951
Time taken: 3926.50 seconds
Epoch: 69 	 Train Loss: 89383.303543	 Test Loss: 89020.047377
Time taken: 4458.85 seconds
Epoch: 79 	 Train Loss: 87940.294819	 Test Loss: 86935.671759
Time taken: 4990.21 seconds
Epoch: 89 	 Train Loss: 86022.329915	 Test Loss: 86152.771682
Time taken: 5519.87 seconds
Epoch: 99 	 Train Loss: 85156.011188	 Test Loss: 84648.153318
Time taken: 6049.39 seconds
Epoch: 109 	 Train Loss: 84015.982752	 Test Loss: 83679.038503
Time taken: 6567.70 seconds
Epoch: 119 	 Train Loss: 82762.409630	 Test Loss: 84079.539583
Time taken: 7091.88 seconds
Epoch: 129 	 Train Loss: 82199.126332	 Test Loss: 83106.194444
Time taken: 7618.57 seconds
Epoch: 139 	 Train Loss: 81425.425479	 Test Loss: 82366.102623
Time taken: 8143.16 seconds
Epoch: 149 	 Train Loss: 80665.071590	 Test Loss: 81978.856713
Finished training
Time taken: 8143.16 seconds
Best test loss: 81691.802238 at epoch: 146
Video loss: 81687.41032021605, at epoch: 146
Timeseries MAPE: 0.000000
Video MAPE: 2.435452
Masked MAPE: 0.000000
Started Cluster task
Latent representations ready

Cluster  2

              K-means results      Spectral clustering results       GMM results
ARI:          -0.00016                    0.00000                  -0.00015
Rand:         0.29183                    0.00000                    0.29220
FM:           0.24745                    0.00000                    0.24739
Completeness: 0.02675                    0.00000                    0.02712
Homogeneity:  0.00439                    0.00000                    0.00445
V measure:    0.00754                    0.00000                    0.00765
Silhouette:   0.34170                    0.00000                    0.34139
CH Score:     1102.20767                 0.00000                    1102.04547

Cluster  4
              K-means results      Spectral clustering results       GMM results
ARI:          0.02167                    0.00182                  0.01497
Rand:         0.70172                    0.40478                    0.67679
FM:           0.17016                    0.22691                    0.17112
Completeness: 0.06272                    0.01529                    0.05123
Homogeneity:  0.03322                    0.00346                    0.02603
V measure:    0.04343                    0.00565                    0.03452
Silhouette:   0.13197                    -0.01064                    0.13247
CH Score:     663.16974                 2.19186                    606.85599

Cluster  6
              K-means results      Spectral clustering results       GMM results
ARI:          0.02413                    0.00157                  0.03022
Rand:         0.77237                    0.49009                    0.77565
FM:           0.14487                    0.20693                    0.14988
Completeness: 0.05868                    0.01418                    0.07234
Homogeneity:  0.04027                    0.00384                    0.04981
V measure:    0.04776                    0.00604                    0.05899
Silhouette:   0.12749                    -0.01336                    0.10998
CH Score:     464.11938                 1.91908                    437.10704

Cluster  8
              K-means results      Spectral clustering results       GMM results
ARI:          0.02800                    -0.00001                  0.03327
Rand:         0.80148                    0.08552                    0.78399
FM:           0.13559                    0.28559                    0.14931
Completeness: 0.07235                    0.27641                    0.08974
Homogeneity:  0.05660                    0.00213                    0.06691
V measure:    0.06352                    0.00422                    0.07666
Silhouette:   0.08165                    0.01805                    0.06166
CH Score:     362.34163                 1.83334                    334.53751

Cluster  10
              K-means results      Spectral clustering results       GMM results
ARI:          0.02801                    0.00254                  0.03222
Rand:         0.83036                    0.54470                    0.83222
FM:           0.12092                    0.19459                    0.12416
Completeness: 0.07486                    0.02053                    0.07742
Homogeneity:  0.06603                    0.00784                    0.06844
V measure:    0.07017                    0.01135                    0.07265
Silhouette:   0.06955                    -0.03432                    0.05947
CH Score:     303.74135                 1.94864                    295.48405

Cluster  12
              K-means results      Spectral clustering results       GMM results
ARI:          0.02911                    0.00219                  0.03175
Rand:         0.84080                    0.75596                    0.84715
FM:           0.11628                    0.12836                    0.11531
Completeness: 0.08217                    0.01572                    0.08305
Homogeneity:  0.07704                    0.01057                    0.07940
V measure:    0.07953                    0.01264                    0.08119
Silhouette:   0.06799                    -0.02788                    0.05766
CH Score:     265.09735                 1.93299                    258.68107

Cluster  14
              K-means results      Spectral clustering results       GMM results
ARI:          0.02576                    0.00154                  0.03171
Rand:         0.85516                    0.66397                    0.85334
FM:           0.10455                    0.15959                    0.11163
Completeness: 0.07608                    0.02334                    0.08478
Homogeneity:  0.07689                    0.01310                    0.08472
V measure:    0.07648                    0.01678                    0.08475
Silhouette:   0.06514                    -0.04659                    0.06091
CH Score:     236.03594                 1.90434                    229.57055
FOR PLOT
[0.3416972, 0.13197438, 0.12749122, 0.08164904, 0.06954978, 0.0679903, 0.06513668]
[1102.2076730644662, 663.1697445115481, 464.11938000662855, 362.34163101426924, 303.74134543457563, 265.0973524997434, 236.035938509322]
[0, -0.010643415, -0.013357015, 0.01804522, -0.03432277, -0.027877888, -0.046585865]
[0, 2.191863299859744, 1.919081289889178, 1.8333362540370204, 1.9486396362718503, 1.9329931689326125, 1.9043353744394032]
[0.34139162, 0.13246632, 0.1099826, 0.061657544, 0.05947434, 0.057656474, 0.06090765]
[1102.0454713681013, 606.8559925698553, 437.1070358335001, 334.537514986459, 295.4840490344978, 258.6810665321478, 229.57054878593675]
 
Finished cluster for  VideoAutoencoder
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
1 [31 69 69 63  0  1  0 41  0  0 25  1  0  0]
2 [ 5 58 39 52  0  1  0 85  0 23 37  0  0  0]
3 [ 3 79 34 44  0  1  0 98  0  7 34  0  0  0]
4 [  7  24  59 100   0   3   0  80   0   8  18   1   0   0]
5 [ 0  9 39 30  0  0  0 61  0  8 13  0  0  0]
6 [22 13 79 70  0  1  0 55  0  6 54  0  0  0]
7 [ 4  6 19 27  0  0  0  8  0  4  4  0  0  0]
8 [ 13  23  48  36   0   0   0  58   0  14 108   0   0   0]
9 [ 6 12  0 17  0  0  0 11  0  0 14  0  0  0]
10 [43 14 48 54  0  0  0 57  0 20 64  0  0  0]
11 [16 41 54 55  0  0  0 81  0  1 52  0  0  0]
12 [ 7 41 19 41  0  0  0 55  0  6 43  0  0  0]
13 [ 8 21  7 19  0  0  0 30  0 12 10  1  0  0]
14 [ 9 20 16 41  0  0  0 72  0 20 50  0  0  0]
F1 Score: 0.08465476962149894
Finished GMM Classification for  VideoAutoencoder
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['1', '5', '9']
1 [161  87  52]
2 [ 81 147  72]
3 [ 92 160  48]
F1 Score: 0.3783024632530045
Finished GMM Classification for  VideoAutoencoder
lr: 0.1, hidden_dim: 1024

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.082975	 Test Loss: 0.084715
Epoch: 9 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 14 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 19 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 24 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 29 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 34 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 39 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 44 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 49 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 54 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 59 	 Train Loss: 0.082954	 Test Loss: 0.084710
Finished training
Best test loss: 0.084710 at epoch: 8
Start evaluation, classes for  range(0, 14)

Evaluation of fine-tuned VideoAutoencoder model

Confusion matrix
['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
1 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
2 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
3 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
4 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
5 [160   0   0   0   0   0   0   0   0   0   0   0   0   0]
6 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
7 [72  0  0  0  0  0  0  0  0  0  0  0  0  0]
8 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
9 [60  0  0  0  0  0  0  0  0  0  0  0  0  0]
10 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
11 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
12 [212   0   0   0   0   0   0   0   0   0   0   0   0   0]
13 [108   0   0   0   0   0   0   0   0   0   0   0   0   0]
14 [228   0   0   0   0   0   0   0   0   0   0   0   0   0]
F1 Score: 0.015693659761456372
lr: 0.1, hidden_dim: 1024

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 9 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 14 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 19 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 24 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 29 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 34 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 39 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 44 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 49 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 54 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 59 	 Train Loss: 0.034533	 Test Loss: 0.012207
Finished training
Best test loss: 0.012207 at epoch: 0
Start evaluation, classes for  [1, 5, 9]

Evaluation of fine-tuned VideoAutoencoder model

Confusion matrix
['1', '5', '9']
1 [300   0   0]
2 [300   0   0]
3 [300   0   0]
F1 Score: 0.16666666666666666

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.030610	 Test Loss: 0.025323
Epoch: 9 	 Train Loss: 0.048436	 Test Loss: 0.020044
Epoch: 14 	 Train Loss: 0.022680	 Test Loss: 0.028440
Epoch: 19 	 Train Loss: 0.019478	 Test Loss: 0.023828
Epoch: 24 	 Train Loss: 0.009932	 Test Loss: 0.010773
Epoch: 29 	 Train Loss: 0.009373	 Test Loss: 0.011221
Epoch: 34 	 Train Loss: 0.008547	 Test Loss: 0.009022
Epoch: 39 	 Train Loss: 0.008533	 Test Loss: 0.008994
Epoch: 44 	 Train Loss: 0.008521	 Test Loss: 0.009107
Epoch: 49 	 Train Loss: 0.008624	 Test Loss: 0.008869
Epoch: 54 	 Train Loss: 0.008602	 Test Loss: 0.009129
Epoch: 59 	 Train Loss: 0.008515	 Test Loss: 0.008948
Finished training VideoAutoencoder for risk score prediction
Best test loss: 0.008869 at epoch: 49
Start evaluation
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 357 with accuracies 
[2.69700438e-15 4.73139585e-05 5.65071334e-05 7.06271862e-05
 4.75912983e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 326 instead with accuracy 
4.168395258432736e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 370 with accuracies 
[3.20635553e-15 8.50421426e-05 6.87408466e-05 8.40101700e-05
 4.65047080e-05 4.82892346e-05 4.55947097e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 333 instead with accuracy 
5.366512365085289e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 328 with accuracies 
[2.10426058e-15 4.05589600e-05 5.14394772e-05 8.38145518e-05
 4.81147583e-05 4.36052304e-05 4.91411224e-05 5.82894373e-05
 4.34920166e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 326 instead with accuracy 
4.618296892835438e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 353 with accuracies 
[1.76161022e-15 3.20786604e-05 3.08664709e-05 4.06830246e-05
 4.53301767e-05 4.30961978e-05 8.14827805e-05 4.84424348e-05
 7.15717427e-05 3.98052778e-05 4.45435633e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 350 instead with accuracy 
4.277750746509201e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 343 with accuracies 
[2.00459880e-15 2.70540002e-05 4.78343082e-05 3.52370888e-05
 4.84004106e-05 3.86474746e-05 4.99178604e-05 4.76473155e-05
 5.11684126e-05 7.90439927e-05 4.83750993e-05 5.70566361e-05
 4.79849901e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 307 instead with accuracy 
4.2881335477555686e-05.

  _, diffusion_map = lobpcg(
/work6/a_sundfjord/thesis/env/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:393: UserWarning: Exited at iteration 334 with accuracies 
[2.09006802e-15 3.70041916e-05 4.13381486e-05 4.51114908e-05
 4.60498134e-05 3.93053440e-05 5.97828397e-05 8.16077332e-05
 4.70277381e-05 6.50596828e-05 5.09929987e-05 4.58243927e-05
 6.60602270e-05 5.82031407e-05 4.80438008e-05]
not reaching the requested tolerance 4.8279762268066406e-05.
Use iteration 331 instead with accuracy 
4.8293640528246254e-05.

  _, diffusion_map = lobpcg(

Evaluation of fine-tuned VideoAutoencoder model

MAPE Score: 1.1531217098236084

Finished
