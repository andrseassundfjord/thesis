Latent dimension: 64, Hidden dimension 512, Split size 4
Started: TimeBERT_reduced_lambda, Augmented run
Using device: cuda
Model: TimeBERT
Number of parameters in model:  36943186
torch.cuda.memory_allocated: 0.138609GB
torch.cuda.memory_reserved: 0.150391GB
torch.cuda.max_memory_reserved: 0.150391GB
Start training
Time taken: 538.41 seconds
Epoch: 9 	 Train Loss: 45145.929842	 Test Loss: 43433.551022
Time taken: 1001.34 seconds
Epoch: 19 	 Train Loss: 45021.993882	 Test Loss: 43327.412789
Time taken: 1449.21 seconds
Epoch: 29 	 Train Loss: 44933.639035	 Test Loss: 42414.583835
Time taken: 1893.81 seconds
Epoch: 39 	 Train Loss: 44963.231786	 Test Loss: 42022.792448
Time taken: 2332.76 seconds
Epoch: 49 	 Train Loss: 44771.559287	 Test Loss: 42013.526804
Time taken: 2773.59 seconds
Epoch: 59 	 Train Loss: 44721.644088	 Test Loss: 42083.560619
Time taken: 3217.94 seconds
Epoch: 69 	 Train Loss: 44704.116293	 Test Loss: 42083.070351
Time taken: 3655.39 seconds
Epoch: 79 	 Train Loss: 44717.754196	 Test Loss: 42081.238648
Time taken: 4091.58 seconds
Epoch: 89 	 Train Loss: 44733.651105	 Test Loss: 42077.901669
Time taken: 4523.65 seconds
Epoch: 99 	 Train Loss: 44747.787960	 Test Loss: 42079.644579
Time taken: 4955.42 seconds
Epoch: 109 	 Train Loss: 44794.118474	 Test Loss: 42081.640606
Time taken: 5384.55 seconds
Epoch: 119 	 Train Loss: 44724.748585	 Test Loss: 42081.365336
Time taken: 5812.02 seconds
Epoch: 129 	 Train Loss: 44770.340187	 Test Loss: 42080.081096
Time taken: 6745.14 seconds
Epoch: 139 	 Train Loss: 44755.249850	 Test Loss: 42080.344367
Time taken: 7938.69 seconds
Epoch: 149 	 Train Loss: 44747.848362	 Test Loss: 42081.970959
Finished training
Time taken: 7938.70 seconds
Best test loss: 41887.719763 at epoch: 27
Timeseries loss: 41871.33306086034
Timeseries MAPE: 1.568477
Video MAPE: 0.000000
Masked MAPE: 1.872417
Started Cluster task
Latent representations ready

Cluster  2
              K-means results      Spectral clustering results       GMM results
ARI:          -0.00058                    0.00000                  -0.00058
Rand:         0.22705                    0.00000                    0.22705
FM:           0.25926                    0.00000                    0.25926
Completeness: 0.02974                    0.00000                    0.02974
Homogeneity:  0.00370                    0.00000                    0.00370
V measure:    0.00658                    0.00000                    0.00658
Silhouette:   0.26432                    0.00000                    0.26432
CH Score:     504.70533                 0.00000                    504.70533

Cluster  4
              K-means results      Spectral clustering results       GMM results
ARI:          0.00033                    -0.00065                  0.00032
Rand:         0.68232                    0.22761                    0.67965
FM:           0.15236                    0.25903                    0.15321
Completeness: 0.01092                    0.03649                    0.01103
Homogeneity:  0.00561                    0.00465                    0.00564
V measure:    0.00741                    0.00825                    0.00746
Silhouette:   0.05865                    -0.02356                    0.03444
CH Score:     251.75308                 167.28293                    196.53570

Cluster  6
              K-means results      Spectral clustering results       GMM results
ARI:          -0.00007                    -0.00075                  0.00071
Rand:         0.77310                    0.23265                    0.77227
FM:           0.11911                    0.25792                    0.12027
Completeness: 0.00873                    0.04455                    0.01040
Homogeneity:  0.00606                    0.00612                    0.00720
V measure:    0.00715                    0.01076                    0.00851
Silhouette:   0.05033                    -0.05182                    0.03536
CH Score:     170.77650                 101.19266                    144.63888

Cluster  8
              K-means results      Spectral clustering results       GMM results
ARI:          0.00094                    -0.00090                  -0.00027
Rand:         0.81226                    0.23111                    0.79970
FM:           0.10277                    0.25797                    0.10742
Completeness: 0.01015                    0.04947                    0.01007
Homogeneity:  0.00825                    0.00690                    0.00790
V measure:    0.00910                    0.01211                    0.00885
Silhouette:   0.04785                    -0.06008                    0.01682
CH Score:     131.59543                 70.19984                    117.63454

Cluster  10
              K-means results      Spectral clustering results       GMM results
ARI:          -0.00000                    -0.00075                  0.00084
Rand:         0.82860                    0.23729                    0.82877
FM:           0.09363                    0.25705                    0.09439
Completeness: 0.01073                    0.05403                    0.01228
Homogeneity:  0.00952                    0.00793                    0.01089
V measure:    0.01009                    0.01383                    0.01155
Silhouette:   0.02752                    -0.06647                    0.02107
CH Score:     108.64799                 57.22868                    102.62608

Cluster  12
              K-means results      Spectral clustering results       GMM results
ARI:          0.00000                    -0.00066                  0.00093
Rand:         0.84579                    0.24474                    0.84826
FM:           0.08416                    0.25578                    0.08364
Completeness: 0.01142                    0.06065                    0.01240
Homogeneity:  0.01103                    0.00972                    0.01208
V measure:    0.01122                    0.01675                    0.01224
Silhouette:   0.02626                    -0.06635                    0.04214
CH Score:     93.33329                 47.60496                    89.05122

Cluster  14
              K-means results      Spectral clustering results       GMM results
ARI:          0.00021                    -0.00089                  -0.00018
Rand:         0.85705                    0.23385                    0.85710
FM:           0.07754                    0.25747                    0.07711
Completeness: 0.01178                    0.06452                    0.01159
Homogeneity:  0.01213                    0.01000                    0.01194
V measure:    0.01195                    0.01732                    0.01177
Silhouette:   0.02538                    -0.08225                    0.02243
CH Score:     81.69829                 35.72349                    79.57938
FOR PLOT
[0.26432037, 0.058646638, 0.050330885, 0.047848262, 0.027516136, 0.0262609, 0.025384348]
[504.70533085780664, 251.75307768644197, 170.77649969632654, 131.59543393156537, 108.64799003933088, 93.33328950979961, 81.69828569455403]
[0, -0.023560159, -0.051823236, -0.06007538, -0.066469036, -0.06634924, -0.082253315]
[0, 167.28293001356107, 101.19266279962736, 70.19983685105662, 57.228680699399774, 47.60495774309008, 35.72349449890452]
[0.26432037, 0.034439545, 0.03536431, 0.01681845, 0.021071633, 0.042139895, 0.022430494]
[504.70533085780664, 196.53569934864328, 144.638877267962, 117.63454374881022, 102.62608294293481, 89.05122270204691, 79.57937859845515]
 
Finished cluster for  TimeBERT
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
1 [  0   0 272   4   0   0   0   0   0   0   0   0   0  24]
2 [  0   0 240  16   0   8   0   0   0   0   0   3   0  33]
3 [  0   0 220  44   0   1   0   0   0   0   0   1   0  34]
4 [  0   0 252  16   0   1   0   0   0   0   0   6   0  25]
5 [  0   0 148   4   0   1   0   0   0   0   0   4   0   3]
6 [  0   0 276   0   0   0   0   0   0   0   0   9   0  15]
7 [ 0  0 68  0  0  0  0  0  0  0  0  0  0  4]
8 [  0   0 272   0   0   4   0   4   0   0   0   0   0  20]
9 [ 0  0 44  8  0  8  0  0  0  0  0  0  0  0]
10 [  0   0 236  28   0   5   0   0   0   0   0   6   0  25]
11 [  0   0 264  12   0   0   0   0   0   4   0   4   0  16]
12 [  0   0 184   8   0   0   0   0   0   0   0   0   0  20]
13 [ 0  0 96  4  0  4  0  0  0  0  0  0  0  4]
14 [  0   0 180   0   0   1   0   0   0   0   0   3   0  44]
F1 Score: 0.034969141805881974
Finished GMM Classification for  TimeBERT
Started GMM classification
Latent representations ready

Evaluation of GMM classification

Confusion matrix
['1', '5', '9']
1 [ 36 248  16]
2 [ 24 276   0]
3 [ 32 240  28]
F1 Score: 0.2884203865144589
Finished GMM Classification for  TimeBERT
lr: 0.1, hidden_dim: 1024

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.082955	 Test Loss: 0.084710
Epoch: 9 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 14 	 Train Loss: 0.082954	 Test Loss: 0.084711
Epoch: 19 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 24 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 29 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 34 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 39 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 44 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 49 	 Train Loss: 0.082954	 Test Loss: 0.084710
Epoch: 54 	 Train Loss: 0.082954	 Test Loss: 0.084711
Epoch: 59 	 Train Loss: 0.082954	 Test Loss: 0.084721
Finished training
Best test loss: 0.084698 at epoch: 1
Start evaluation, classes for  range(0, 14)

Evaluation of fine-tuned TimeBERT model

Confusion matrix
['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
1 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
2 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
3 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
4 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
5 [160   0   0   0   0   0   0   0   0   0   0   0   0   0]
6 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
7 [72  0  0  0  0  0  0  0  0  0  0  0  0  0]
8 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
9 [60  0  0  0  0  0  0  0  0  0  0  0  0  0]
10 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
11 [300   0   0   0   0   0   0   0   0   0   0   0   0   0]
12 [212   0   0   0   0   0   0   0   0   0   0   0   0   0]
13 [108   0   0   0   0   0   0   0   0   0   0   0   0   0]
14 [228   0   0   0   0   0   0   0   0   0   0   0   0   0]
F1 Score: 0.015693659761456372
lr: 0.1, hidden_dim: 1024

Start classification fine-tuning
Epoch: 4 	 Train Loss: 0.034578	 Test Loss: 0.012207
Epoch: 9 	 Train Loss: 0.034588	 Test Loss: 0.012207
Epoch: 14 	 Train Loss: 0.034535	 Test Loss: 0.012207
Epoch: 19 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 24 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 29 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 34 	 Train Loss: 0.034533	 Test Loss: 0.012199
Epoch: 39 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 44 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 49 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 54 	 Train Loss: 0.034533	 Test Loss: 0.012207
Epoch: 59 	 Train Loss: 0.034533	 Test Loss: 0.012207
Finished training
Best test loss: 0.012193 at epoch: 1
Start evaluation, classes for  [1, 5, 9]

Evaluation of fine-tuned TimeBERT model

Confusion matrix
['1', '5', '9']
1 [300   0   0]
2 [300   0   0]
3 [300   0   0]
F1 Score: 0.16666666666666666

Start risk score fine-tuning
Epoch: 4 	 Train Loss: 0.018134	 Test Loss: 0.013675
Epoch: 9 	 Train Loss: 0.025294	 Test Loss: 0.019230
Epoch: 14 	 Train Loss: 0.009700	 Test Loss: 0.009450
Epoch: 19 	 Train Loss: 0.008902	 Test Loss: 0.009240
Epoch: 24 	 Train Loss: 0.009099	 Test Loss: 0.010071
Epoch: 29 	 Train Loss: 0.009537	 Test Loss: 0.009252
Epoch: 34 	 Train Loss: 0.008553	 Test Loss: 0.009113
Epoch: 39 	 Train Loss: 0.008589	 Test Loss: 0.009118
Epoch: 44 	 Train Loss: 0.008467	 Test Loss: 0.008979
Epoch: 49 	 Train Loss: 0.008506	 Test Loss: 0.008964
Epoch: 54 	 Train Loss: 0.008504	 Test Loss: 0.008978
Epoch: 59 	 Train Loss: 0.008458	 Test Loss: 0.008980
Finished training TimeBERT for risk score prediction
Best test loss: 0.008962 at epoch: 57
Start evaluation

Evaluation of fine-tuned TimeBERT model

MAPE Score: 1.0437959432601929

Finished
